<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction to Formulaic • formulaic</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to Formulaic">
<meta property="og:description" content="formulaic">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">formulaic</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.8</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Introduction-to-formulaic.html">Introduction to Formulaic</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/dachosen1/formulaic/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="Introduction-to-formulaic_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Introduction to Formulaic</h1>
                        <h4 class="author">Authors: David Shilane, Caffrey Lee, Zoe Huang, Anderson Nelson</h4>
            
            <h4 class="date">2021-03-25</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/dachosen1/formulaic/blob/master/vignettes/Introduction-to-formulaic.Rmd"><code>vignettes/Introduction-to-formulaic.Rmd</code></a></small>
      <div class="hidden name"><code>Introduction-to-formulaic.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>Across a wide variety of statistical techniques and machine learning algorithms, R’s formula object provides a standardized process for specifying the outcomes and inputs to be utilized when a method is applied to a data set. In typical examples, e.g. R’s help file for formula objects, a model is specified in a manual way with a formula such as <strong>y ~ a + b + c</strong>. For parsimonious models specified by a programmer, a manual selection and entry can be sufficient. However, a variety of applications can present more challenging circumstances in which manual specification may not be an effective strategy. Dynamically generated models may be specified by the user of a graphical interface (e.g. with R’s shiny package). In this case, a programmatic means of specifying a formula based on the user’s selections would be necessary. Even in manual settings, formula objects would benefit from additional quality checks that ensure that the model’s specification is appropriate for the data provided.</p>
<p>Formulaic package has two main functions – <strong>create.formula</strong> and <strong>reduce.existing.formula</strong> – and one subsidiary function, <strong>add.backtick</strong>. The main purpose of developing the package is to help users to build a robust model faster and more convenient.</p>
<p><strong>create.formula</strong> automatically creates a formula from a provided list of input variables and the output variable. The variables will undergo a series of qualification tests such as automatic variable/categories reduction, typo, duplication, and lack of contrasted features elimination, etc. to make sure that a given feature is usable for modeling. This will reduce the time to build a model and set the users free from the trivial maneuver: manually inputting variables for modeling. The outcome of this formula can be used in a wide range from simple linear regression to more complex machine learning techniques such as random forest, neural network, etc.</p>
<p>The principal advantages of using create.formula are followed:</p>
<ol style="list-style-type: decimal">
<li><p>Being able to dynamically generate a formula from a vector of inputs, without necessarily having to spell them all out by name.</p></li>
<li><p>Adding variables by searching for patterns.</p></li>
<li><p>Simple integration of interactions.</p></li>
<li><p>Easy removal of specific variables.</p></li>
<li><p>Quality checks that resolve a variety of issues – typos, duplication, lack of contrast, etc. – while providing a transparent explanation.</p></li>
</ol>
<p><strong>reduce.existing.formula</strong> trims an existing formula down. Users plug an existing formula into the function, then it will undergo the same test as create.formula.</p>
<p><strong>add.backticks</strong> applies backticks the variables needs backticks to be employed in a formula as default. Users can also add backticks to all the variables; however, it is not necessary.</p>
<p><strong>formulaic</strong> is useful to create a dynamic formula with multiple features. It not only diminishes the time required for modeling and implementing, but also enriches the quality of the result.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">awareness.name</span> <span class="op">=</span> <span class="st">"Awareness"</span>
<span class="va">variable.names</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Age"</span>, <span class="st">"Gender"</span>, <span class="st">"Income Group"</span>, <span class="st">"Region"</span>, <span class="st">"Persona"</span>, <span class="st">"Typo"</span><span class="op">)</span>

<span class="va">ex.form</span> <span class="op">&lt;-</span>
  <span class="fu"><a href="../reference/create.formula.html">create.formula</a></span><span class="op">(</span>outcome.name <span class="op">=</span> <span class="va">awareness.name</span>,
                 input.names <span class="op">=</span> <span class="va">variable.names</span>,
                 dat <span class="op">=</span> <span class="va">snack.dat</span><span class="op">)</span>

<span class="va">ex.form</span><span class="op">$</span><span class="va">formula</span>
<span class="co">#&gt; Awareness ~ Age + Gender + `Income Group` + Region + Persona</span>
<span class="co">#&gt; &lt;environment: 0x00000000192cfd98&gt;</span>
<span class="va">lm_example</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">ex.form</span>, data <span class="op">=</span> <span class="va">snack.dat</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">lm_example</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; lm(formula = ex.form, data = snack.dat)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Residuals:</span>
<span class="co">#&gt;     Min      1Q  Median      3Q     Max </span>
<span class="co">#&gt; -0.5853 -0.5245  0.4440  0.4743  0.5196 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Coefficients:</span>
<span class="co">#&gt;                                 Estimate Std. Error t value Pr(&gt;|t|)    </span>
<span class="co">#&gt; (Intercept)                    0.5593478  0.0149319  37.460  &lt; 2e-16 ***</span>
<span class="co">#&gt; Age                           -0.0001466  0.0001554  -0.943 0.345786    </span>
<span class="co">#&gt; GenderMale                    -0.0217796  0.0066156  -3.292 0.000996 ***</span>
<span class="co">#&gt; `Income Group`[ 50000, 75000)  0.0090771  0.0100586   0.902 0.366845    </span>
<span class="co">#&gt; `Income Group`[ 75000,100000)  0.0057200  0.0102907   0.556 0.578322    </span>
<span class="co">#&gt; `Income Group`[100000,150000)  0.0066225  0.0084932   0.780 0.435549    </span>
<span class="co">#&gt; `Income Group`[150000,250000]  0.0377699  0.0376171   1.004 0.315359    </span>
<span class="co">#&gt; RegionNortheast               -0.0009939  0.0097772  -0.102 0.919034    </span>
<span class="co">#&gt; RegionSouth                   -0.0096367  0.0117113  -0.823 0.410600    </span>
<span class="co">#&gt; RegionWest                    -0.0327901  0.0094162  -3.482 0.000498 ***</span>
<span class="co">#&gt; PersonaMainstream Maynard     -0.0030736  0.0105171  -0.292 0.770099    </span>
<span class="co">#&gt; PersonaMillenial Muncher      -0.0108831  0.0112126  -0.971 0.331752    </span>
<span class="co">#&gt; PersonaOld School Oliver      -0.0078579  0.0132893  -0.591 0.554332    </span>
<span class="co">#&gt; PersonaRighteous Reviewer     -0.0057425  0.0121762  -0.472 0.637203    </span>
<span class="co">#&gt; PersonaSavvy Samantha         -0.0111625  0.0110298  -1.012 0.311536    </span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Residual standard error: 0.4991 on 22985 degrees of freedom</span>
<span class="co">#&gt; Multiple R-squared:  0.001567,   Adjusted R-squared:  0.0009586 </span>
<span class="co">#&gt; F-statistic: 2.576 on 14 and 22985 DF,  p-value: 0.001026</span></code></pre></div>
<div id="dynamic-generation-of-a-formula" class="section level2">
<h2 class="hasAnchor">
<a href="#dynamic-generation-of-a-formula" class="anchor"></a>Dynamic Generation of a Formula</h2>
<p>A formula object may be one component of a larger system of software that processes data, generates models, and reports information. Dynamic applications with user interfaces, such as those generated with the shiny package, can allow a user to specify many of the parameters. This may include the type of model to fit, the outcome and input variables, and filters on the subset of the data to incorporate.</p>
<p>In this application, the user is provided with a wide array of choices. A variety of outcomes related to customer engagement may be modeled. The user can select a subset of data related to a specific brand or aggregate multiple brands together. The user may also choose from a menu of inputs spanning all relevant columns of the data set. Then these data can be filtered into specific subgroups based on selections across a number of variables, including age groups, gender, income groups, region, etc.</p>
<p>Because the user’s selections are dynamic, the modeling formula must be generated programmatically. The create.formula function includes parameters for the <strong>outcome.name</strong> – a character vector of length 1 – and the <strong>input.names</strong> – a character vector of any length. As an example, if the user provides specific selections, then create.formula will automatically generate the corresponding formula object:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">user.outcome.name</span> <span class="op">&lt;-</span> <span class="st">"Satisfaction"</span>
<span class="va">user.input.names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'Age Group'</span>, <span class="st">'Gender'</span>, <span class="st">'Region'</span><span class="op">)</span>

<span class="fu"><a href="../reference/create.formula.html">create.formula</a></span><span class="op">(</span>outcome.name <span class="op">=</span> <span class="va">user.outcome.name</span>, input.names <span class="op">=</span> <span class="va">user.input.names</span><span class="op">)</span><span class="op">$</span><span class="va">formula</span>
<span class="co">#&gt; Satisfaction ~ `Age Group` + Gender + Region</span>
<span class="co">#&gt; &lt;environment: 0x000000001967ce50&gt;</span></code></pre></div>
</div>
<div id="dataset-snack-dat" class="section level2">
<h2 class="hasAnchor">
<a href="#dataset-snack-dat" class="anchor"></a>Dataset (snack.dat)</h2>
<p>For the illustration of the basic functions of the formulaic package, we generated a dataset, named snack.dat.</p>
<p>Formatted as data.table object, snack.dat contains 23000 observations and 25 columns. These data contain simulated information from a fictionalized marketing survey. In this survey, a progression of questions was asked about the respondents’ awareness, consideration, consumption, satisfaction with, and advocacy for different brands of snack foods. Questions downstream of awareness, consideration, and then consumption would be asked only for those respondents who responded affirmatively to the previous question. Otherwise, the values are missing. Brand Perception questions are rated on a scale from 0 to 10 and indicated with a name starting with the prefix BP.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">snack.dat</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">snack.dat</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [[1]]</span>
<span class="co">#&gt; [1] 23000    25</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[2]]</span>
<span class="co">#&gt;  [1] "User ID"                   "Age"                      </span>
<span class="co">#&gt;  [3] "Gender"                    "Income"                   </span>
<span class="co">#&gt;  [5] "Region"                    "Persona"                  </span>
<span class="co">#&gt;  [7] "Product"                   "Awareness"                </span>
<span class="co">#&gt;  [9] "BP_For_Me_0_10"            "BP_Fits_Budget_0_10"      </span>
<span class="co">#&gt; [11] "BP_Tastes_Great_0_10"      "BP_Good_To_Share_0_10"    </span>
<span class="co">#&gt; [13] "BP_Like_Logo_0_10"         "BP_Special_Occasions_0_10"</span>
<span class="co">#&gt; [15] "BP_Everyday_Snack_0_10"    "BP_Healthy_0_10"          </span>
<span class="co">#&gt; [17] "BP_Delicious_0_10"         "BP_Right_Amount_0_10"     </span>
<span class="co">#&gt; [19] "BP_Relaxing_0_10"          "Consideration"            </span>
<span class="co">#&gt; [21] "Consumption"               "Satisfaction"             </span>
<span class="co">#&gt; [23] "Advocacy"                  "Age Group"                </span>
<span class="co">#&gt; [25] "Income Group"</span></code></pre></div>
</div>
<div id="adding-backticks-add-backtick" class="section level2">
<h2 class="hasAnchor">
<a href="#adding-backticks-add-backtick" class="anchor"></a>Adding Backticks (add.backtick)</h2>
<p>As a subsidiary function, add.backtick is used inside of create.formula function that adds backticks to the names of the variables. Formula objects include the names of different variables within a data.frame. When these names contain a space, the name must be encapsulated in backticks to ensure proper formatting. For instance, if there are three variables called y, x1, and User ID, then a formula formatted as y ~ x1 + User ID will generate <strong>errors due to the space in User ID</strong>. Instead, this formula can be properly formatted as <code>y ~ x1 + `User ID`</code>. Meanwhile, it is also acceptable to add backticks to the other names, such as <code>`y` ~ `x1` + `User ID`</code>, but this is not a necessary step. As a default, the include.backtick is set to ‘as.needed’, which indicates that the function will only add backticks to the variables that require them. The user has the freedom to change the option to ‘all’. Yet, it is only compatible when format.as != “formula”, in which case a character object is returned. In particular, a formula object will automatically remove unnecessary backticks.</p>
<p><strong>NOTE</strong>: In the snack.dat data, <strong>User ID, Age Group, and Income Group</strong> are the only variables that are affected by the function when the included.backtick is set as ‘as.needed’, while every variable has backticks when it is set as ‘all’.</p>
<p><strong>Update Notes</strong>: The add.backtick function now accepts the data.frame dat as an additional input (not required). When provided, the judgment about when to use backticks is based on whether the input exists as a variable name of dat and requires backticks. Other cases (like transformations) will not include them. Please refer to the example 5.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">as.needed</span> <span class="op">=</span> <span class="fu">formulaic</span><span class="fu">::</span><span class="fu"><a href="../reference/add.backtick.html">add.backtick</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">snack.dat</span><span class="op">)</span>, include.backtick <span class="op">=</span> <span class="st">'as.needed'</span><span class="op">)</span>
<span class="va">all</span> <span class="op">=</span> <span class="fu">formulaic</span><span class="fu">:::</span><span class="fu"><a href="../reference/add.backtick.html">add.backtick</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">snack.dat</span><span class="op">)</span>, include.backtick <span class="op">=</span> <span class="st">'all'</span><span class="op">)</span>


<span class="va">data</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">as.needed</span>, <span class="va">all</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>
<span class="co">#&gt; [[1]]</span>
<span class="co">#&gt;       as.needed                   all                          </span>
<span class="co">#&gt;  [1,] "`User ID`"                 "`User ID`"                  </span>
<span class="co">#&gt;  [2,] "Age"                       "`Age`"                      </span>
<span class="co">#&gt;  [3,] "Gender"                    "`Gender`"                   </span>
<span class="co">#&gt;  [4,] "Income"                    "`Income`"                   </span>
<span class="co">#&gt;  [5,] "Region"                    "`Region`"                   </span>
<span class="co">#&gt;  [6,] "Persona"                   "`Persona`"                  </span>
<span class="co">#&gt;  [7,] "Product"                   "`Product`"                  </span>
<span class="co">#&gt;  [8,] "Awareness"                 "`Awareness`"                </span>
<span class="co">#&gt;  [9,] "BP_For_Me_0_10"            "`BP_For_Me_0_10`"           </span>
<span class="co">#&gt; [10,] "BP_Fits_Budget_0_10"       "`BP_Fits_Budget_0_10`"      </span>
<span class="co">#&gt; [11,] "BP_Tastes_Great_0_10"      "`BP_Tastes_Great_0_10`"     </span>
<span class="co">#&gt; [12,] "BP_Good_To_Share_0_10"     "`BP_Good_To_Share_0_10`"    </span>
<span class="co">#&gt; [13,] "BP_Like_Logo_0_10"         "`BP_Like_Logo_0_10`"        </span>
<span class="co">#&gt; [14,] "BP_Special_Occasions_0_10" "`BP_Special_Occasions_0_10`"</span>
<span class="co">#&gt; [15,] "BP_Everyday_Snack_0_10"    "`BP_Everyday_Snack_0_10`"   </span>
<span class="co">#&gt; [16,] "BP_Healthy_0_10"           "`BP_Healthy_0_10`"          </span>
<span class="co">#&gt; [17,] "BP_Delicious_0_10"         "`BP_Delicious_0_10`"        </span>
<span class="co">#&gt; [18,] "BP_Right_Amount_0_10"      "`BP_Right_Amount_0_10`"     </span>
<span class="co">#&gt; [19,] "BP_Relaxing_0_10"          "`BP_Relaxing_0_10`"         </span>
<span class="co">#&gt; [20,] "Consideration"             "`Consideration`"            </span>
<span class="co">#&gt; [21,] "Consumption"               "`Consumption`"              </span>
<span class="co">#&gt; [22,] "Satisfaction"              "`Satisfaction`"             </span>
<span class="co">#&gt; [23,] "Advocacy"                  "`Advocacy`"                 </span>
<span class="co">#&gt; [24,] "`Age Group`"               "`Age Group`"                </span>
<span class="co">#&gt; [25,] "`Income Group`"            "`Income Group`"</span></code></pre></div>
<p>This feature is automatically incorporated into formulaic’s create.formula method:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/create.formula.html">create.formula</a></span><span class="op">(</span>outcome.name <span class="op">=</span> <span class="va">awareness.name</span>, input.names <span class="op">=</span> <span class="va">variable.names</span><span class="op">)</span><span class="op">$</span><span class="va">formula</span>
<span class="co">#&gt; Awareness ~ Age + Gender + `Income Group` + Region + Persona + </span>
<span class="co">#&gt;     Typo</span>
<span class="co">#&gt; &lt;environment: 0x000000001737fc00&gt;</span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/create.formula.html">create.formula</a></span><span class="op">(</span>
  outcome.name <span class="op">=</span> <span class="va">awareness.name</span>,
  input.names <span class="op">=</span> <span class="va">variable.names</span>,
  format.as <span class="op">=</span> <span class="st">"character"</span>,
  include.backtick <span class="op">=</span> <span class="st">"all"</span>
<span class="op">)</span><span class="op">$</span><span class="va">formula</span>
<span class="co">#&gt; [1] "`Awareness` ~ `Age` + `Gender` + `Income Group` + `Region` + `Persona` + `Typo`"</span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/create.formula.html">create.formula</a></span><span class="op">(</span>
  outcome.name <span class="op">=</span> <span class="va">awareness.name</span>,
  input.names <span class="op">=</span> <span class="va">variable.names</span>,
  format.as <span class="op">=</span> <span class="st">"character"</span>,
  include.backtick <span class="op">=</span> <span class="st">"all"</span>
<span class="op">)</span><span class="op">$</span><span class="va">formula</span>
<span class="co">#&gt; [1] "`Awareness` ~ `Age` + `Gender` + `Income Group` + `Region` + `Persona` + `Typo`"</span></code></pre></div>
<p>When the output is returned as a formula object, the backticks may only be provided on an as-needed basis. For character objects, either option may be selected.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/create.formula.html">create.formula</a></span><span class="op">(</span>
  outcome.name <span class="op">=</span> <span class="va">awareness.name</span>,
  input.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">region.name</span>, <span class="va">gender.name</span>, <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"sqrt(%s^2)"</span>, <span class="va">age.name</span><span class="op">)</span>, <span class="va">income.group.name</span>, <span class="st">"ldkao"</span><span class="op">)</span>,
  format.as <span class="op">=</span> <span class="st">"character"</span>, 
  include.backtick <span class="op">=</span> <span class="st">"as.needed"</span>
<span class="op">)</span><span class="op">$</span><span class="va">formula</span>
<span class="co">#&gt; [1] "Awareness ~ Region + Gender + `sqrt(Age^2)` + `Income Group` + ldkao"</span></code></pre></div>
<p>A transformation like sqrt(Age) should specifically not be placed inside of backticks.</p>
</div>
<div id="creating-formula-create-formula" class="section level2">
<h2 class="hasAnchor">
<a href="#creating-formula-create-formula" class="anchor"></a>Creating Formula (create.formula):</h2>
<p>The create.formula function is designed to automatically generate formulas from user-specified inputs and output. The range of inputs may include directly specified variables, patterns to search within the names of an associated data.frame, a list of interactions, and a vector of variables to directly exclude from consideration. The method also provides a range of quality checks that can detect issues with the construction of formula and, at the user’s discretion, automatically remove variables that would otherwise generate errors. These quality checks include formatting variables with backticks, de-duplication, ensuring correspondence with the names of the variables in an associated data.frame, excluding categorical variables that would generate errors due to a lack of contrast or exceed a user-specified threshold for the maximum number of categories, and automatically removing interactions involving variables that should be excluded. When directed by the user, these quality checks can be implemented to effectively reduce a formula to the subset of variables and interactions that would be appropriate for consideration in a statistical model. The output of the function can be formatted as either a formula object or a character.</p>
<p><strong>Update Notes</strong>: the create.formula function now evaluates the inputs and outcomes to see if real results are generated rather than looking for the names of existing variables. This means that any transformation – e.g. sqrt(Age^2 * log(Income)) – is potentially available for inclusion. Likewise, the outcomes can also be transformations like log(Income).</p>
<div id="parameter-description" class="section level3">
<h3 class="hasAnchor">
<a href="#parameter-description" class="anchor"></a>Parameter description:</h3>
<ul>
<li><p><strong>outcome.name</strong> A character value specifying the name of the formula’s outcome variable. In this version, only a single outcome may be included. The first entry of outcome.name will be used to build the formula.</p></li>
<li><p><strong>input.names</strong> The names of the variables with the full names delineated.</p></li>
<li><p><strong>input.patterns</strong> Includes additional input variables. The user may enter patterns – e.g. to include every variable with a name that includes the pattern. Multiple patterns may be included as a character vector. However, each pattern may not contain spaces and is otherwise subject to the same limits on patterns as used in the grep function.</p></li>
<li><p><strong>dat</strong> User can specify a data.frame object that will be used to remove any variables that are not listed in names(dat. As default it is set as NULL. In this case, the formula is created simply from the outcome.name and input.names.</p></li>
<li><p><strong>interactions</strong> A list of character vectors. Each character vector includes the names of the variables that form a single interaction. Specifying interactions = list(c(“x”, “y”), c(“x”, “z”), c(“y”, “z”), c(“x”, “y”, “z”)) would lead to the interactions x<em>y + x</em>z + y<em>z + x</em>y*z. #’ <span class="citation">@param</span> force.main.effects This is a logical value. When TRUE, the intent is that any term included as an interaction (of multiple variables) must also be listed individually as a main effect.</p></li>
<li><p><strong>reduce</strong> A logical value. When dat is not NULL and reduce is TRUE, additional quality checks are performed to examine the input variables. Any input variables that exhibit a lack of contrast will be excluded from the model. This search is global by default but may be conducted separately in subsets of the outcome variables by specifying max.outcome.categories.to.search. Additionally, any input variables that exhibit too many contrasts, as defined by max.input.categories, will also be excluded.</p></li>
<li><p><strong>max.input.categories</strong> Limits the maximum number of variables that will be employed in the formula. As default it is set at 20, but users can still change at his/her convenience.</p></li>
<li><p><strong>max.outcome.categories.to.search</strong> A numeric value. The create.formula function includes a feature that identifies input variables exhibiting a lack of contrast. When reduce = TRUE, these variables are automatically excluded from the resulting formula. This search may be expanded to subsets of the outcome when the number of unique measured values of the outcome is no greater than max.outcome.categories.to.search. In this case, each subset of the outcome will be separately examined, and any inputs that exhibit a lack of contrast within at least one subset will be excluded.</p></li>
<li><p><strong>order.as</strong> User can specify the order the input variables in the formula in a variety of ways for patterns: increasing for increasing alphabet order, decreasing for decreasing alphabet order, column.order for as they appear in data, and as.specified for maintaining the user’s specified order.</p></li>
<li><p><strong>include.backtick</strong> Add backticks if needed. As default it is set as ‘as.needed’, which add backticks when only it is needed. The other option is ‘all’. The use of include.backtick = “all” is limited to cases in which the output is generated as a character variable. When the output is generated as a formula object, then R automatically removes all unnecessary backticks. That is, it is only compatible when format.as != formula.</p></li>
<li><p><strong>format.as</strong> The data type of the output. If not set as “formula”, then a character vector will be returned.</p></li>
<li><p><strong>variables.to.exclude</strong> A character vector. Any variable specified in variables.to.exclude will be dropped from the formula, both in the individual inputs and in any associated interactions. This step supersedes the inclusion of any variables specified for inclusion in the other parameters.</p></li>
<li><p><strong>include.intercept</strong> A logical value. When FALSE, the intercept will be removed from the formula.</p></li>
</ul>
</div>
<div id="basic-format" class="section level3">
<h3 class="hasAnchor">
<a href="#basic-format" class="anchor"></a>Basic format</h3>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">outcome.name.awareness</span> <span class="op">&lt;-</span> <span class="st">"Awareness"</span>
<span class="va">input.names</span> <span class="op">&lt;-</span>
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Age"</span>, <span class="st">"Gender"</span>, <span class="st">"Income"</span>, <span class="st">"Region"</span>, <span class="st">"Persona"</span>, <span class="st">"Typo"</span><span class="op">)</span>

<span class="va">basic.form</span> <span class="op">&lt;-</span>
  <span class="fu"><a href="../reference/create.formula.html">create.formula</a></span><span class="op">(</span>outcome.name <span class="op">=</span> <span class="va">outcome.name.awareness</span>,
                 input.names <span class="op">=</span> <span class="va">input.names</span>,
                 dat <span class="op">=</span> <span class="va">snack.dat</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">basic.form</span><span class="op">)</span>
<span class="co">#&gt; $formula</span>
<span class="co">#&gt; Awareness ~ Age + Gender + Income + Region + Persona</span>
<span class="co">#&gt; &lt;environment: 0x000000001dea1f00&gt;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $inclusion.table</span>
<span class="co">#&gt;    variable exclude.null.quantity   class order specified.from</span>
<span class="co">#&gt; 1:      Age                 FALSE integer     1    input.names</span>
<span class="co">#&gt; 2:   Gender                 FALSE  factor     2    input.names</span>
<span class="co">#&gt; 3:   Income                 FALSE numeric     3    input.names</span>
<span class="co">#&gt; 4:   Region                 FALSE  factor     4    input.names</span>
<span class="co">#&gt; 5:  Persona                 FALSE  factor     5    input.names</span>
<span class="co">#&gt; 6:     Typo                  TRUE    &lt;NA&gt;     6    input.names</span>
<span class="co">#&gt;    exclude.user.specified exclude.matches.outcome.name include.variable</span>
<span class="co">#&gt; 1:                  FALSE                        FALSE             TRUE</span>
<span class="co">#&gt; 2:                  FALSE                        FALSE             TRUE</span>
<span class="co">#&gt; 3:                  FALSE                        FALSE             TRUE</span>
<span class="co">#&gt; 4:                  FALSE                        FALSE             TRUE</span>
<span class="co">#&gt; 5:                  FALSE                        FALSE             TRUE</span>
<span class="co">#&gt; 6:                     NA                        FALSE            FALSE</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $interactions.table</span>
<span class="co">#&gt; Empty data.table (0 rows and 2 cols): interactions,include.interaction</span></code></pre></div>
</div>
<div id="creating-interactions-of-variables" class="section level3">
<h3 class="hasAnchor">
<a href="#creating-interactions-of-variables" class="anchor"></a>Creating Interactions of Variables</h3>
<p>The function allows users to incorporate interaction terms easily with the <strong>interactions</strong> parameter. Each interaction would be specified as a character vector, and the entire range of interactions is entered as a list, which allows for different interactions to include a different number of variables:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">interactions</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Age Group"</span>, <span class="st">"Gender"</span><span class="op">)</span>,
                    <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Age Group"</span>, <span class="st">"Region"</span><span class="op">)</span>,
                    <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Age Group"</span>, <span class="st">"Gender"</span>, <span class="st">"Region"</span><span class="op">)</span><span class="op">)</span>

<span class="va">interaction.form</span> <span class="op">&lt;-</span>
  <span class="fu"><a href="../reference/create.formula.html">create.formula</a></span><span class="op">(</span>
    outcome.name <span class="op">=</span> <span class="va">outcome.name.awareness</span>,
    input.names <span class="op">=</span> <span class="va">input.names</span>,
    dat <span class="op">=</span> <span class="va">snack.dat</span>,
    interactions <span class="op">=</span> <span class="va">interactions</span>
  <span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">interaction.form</span><span class="op">)</span>
<span class="co">#&gt; $formula</span>
<span class="co">#&gt; Awareness ~ Age + Gender + Income + Region + Persona + `Age Group` + </span>
<span class="co">#&gt;     `Age Group` * Gender + `Age Group` * Region + `Age Group` * </span>
<span class="co">#&gt;     Gender * Region</span>
<span class="co">#&gt; &lt;environment: 0x0000000021058f68&gt;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $inclusion.table</span>
<span class="co">#&gt;     variable exclude.null.quantity   class order specified.from</span>
<span class="co">#&gt; 1:       Age                 FALSE integer     1    input.names</span>
<span class="co">#&gt; 2:    Gender                 FALSE  factor     2    input.names</span>
<span class="co">#&gt; 3:    Income                 FALSE numeric     3    input.names</span>
<span class="co">#&gt; 4:    Region                 FALSE  factor     4    input.names</span>
<span class="co">#&gt; 5:   Persona                 FALSE  factor     5    input.names</span>
<span class="co">#&gt; 6:      Typo                  TRUE    &lt;NA&gt;     6    input.names</span>
<span class="co">#&gt; 7: Age Group                 FALSE  factor     7   interactions</span>
<span class="co">#&gt;    exclude.user.specified exclude.matches.outcome.name include.variable</span>
<span class="co">#&gt; 1:                  FALSE                        FALSE             TRUE</span>
<span class="co">#&gt; 2:                  FALSE                        FALSE             TRUE</span>
<span class="co">#&gt; 3:                  FALSE                        FALSE             TRUE</span>
<span class="co">#&gt; 4:                  FALSE                        FALSE             TRUE</span>
<span class="co">#&gt; 5:                  FALSE                        FALSE             TRUE</span>
<span class="co">#&gt; 6:                     NA                        FALSE            FALSE</span>
<span class="co">#&gt; 7:                  FALSE                        FALSE             TRUE</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $interactions.table</span>
<span class="co">#&gt;                     interactions include.interaction</span>
<span class="co">#&gt; 1:          `Age Group` * Gender                TRUE</span>
<span class="co">#&gt; 2:          `Age Group` * Region                TRUE</span>
<span class="co">#&gt; 3: `Age Group` * Gender * Region                TRUE</span></code></pre></div>
</div>
<div id="selecting-variables-from-patterns" class="section level3">
<h3 class="hasAnchor">
<a href="#selecting-variables-from-patterns" class="anchor"></a>Selecting Variables from Patterns</h3>
<p>Large data sets may include classes of variables that are identified with a common pattern within their names. Rather than including each variable individually, it can be helpful to programmatically identify all of the variables that correspond to a specific pattern. For instance, the variables with prefix of BP_ in the snack.dat dataset.</p>
<p>When a set of patterns is specified with the <strong>input.patterns</strong> parameter, the create.formula function identifies any variable that includes at least one of these patterns for inclusion in the formula. In order to do so, the user must also specify the data to be searched. As an example, consider the example below:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">bp.pattern</span> <span class="op">=</span> <span class="st">"BP_"</span>
<span class="va">input.patterns</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Gend"</span>, <span class="va">bp.pattern</span><span class="op">)</span>

<span class="va">pattern.form</span> <span class="op">&lt;-</span>
  <span class="fu"><a href="../reference/create.formula.html">create.formula</a></span><span class="op">(</span>
    outcome.name <span class="op">=</span> <span class="va">outcome.name.awareness</span>,
    input.names <span class="op">=</span> <span class="va">input.names</span>,
    dat <span class="op">=</span> <span class="va">snack.dat</span>,
    input.patterns <span class="op">=</span> <span class="va">input.patterns</span>
  <span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">pattern.form</span><span class="op">)</span>
<span class="co">#&gt; $formula</span>
<span class="co">#&gt; Awareness ~ Age + Gender + Income + Region + Persona + BP_For_Me_0_10 + </span>
<span class="co">#&gt;     BP_Fits_Budget_0_10 + BP_Tastes_Great_0_10 + BP_Good_To_Share_0_10 + </span>
<span class="co">#&gt;     BP_Like_Logo_0_10 + BP_Special_Occasions_0_10 + BP_Everyday_Snack_0_10 + </span>
<span class="co">#&gt;     BP_Healthy_0_10 + BP_Delicious_0_10 + BP_Right_Amount_0_10 + </span>
<span class="co">#&gt;     BP_Relaxing_0_10</span>
<span class="co">#&gt; &lt;environment: 0x000000002271cab0&gt;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $inclusion.table</span>
<span class="co">#&gt;                      variable exclude.null.quantity   class order</span>
<span class="co">#&gt;  1:                       Age                 FALSE integer     1</span>
<span class="co">#&gt;  2:                    Gender                 FALSE  factor     2</span>
<span class="co">#&gt;  3:                    Income                 FALSE numeric     3</span>
<span class="co">#&gt;  4:                    Region                 FALSE  factor     4</span>
<span class="co">#&gt;  5:                   Persona                 FALSE  factor     5</span>
<span class="co">#&gt;  6:                      Typo                  TRUE    &lt;NA&gt;     6</span>
<span class="co">#&gt;  7:            BP_For_Me_0_10                 FALSE integer     7</span>
<span class="co">#&gt;  8:       BP_Fits_Budget_0_10                 FALSE integer     8</span>
<span class="co">#&gt;  9:      BP_Tastes_Great_0_10                 FALSE integer     9</span>
<span class="co">#&gt; 10:     BP_Good_To_Share_0_10                 FALSE integer    10</span>
<span class="co">#&gt; 11:         BP_Like_Logo_0_10                 FALSE integer    11</span>
<span class="co">#&gt; 12: BP_Special_Occasions_0_10                 FALSE integer    12</span>
<span class="co">#&gt; 13:    BP_Everyday_Snack_0_10                 FALSE integer    13</span>
<span class="co">#&gt; 14:           BP_Healthy_0_10                 FALSE integer    14</span>
<span class="co">#&gt; 15:         BP_Delicious_0_10                 FALSE integer    15</span>
<span class="co">#&gt; 16:      BP_Right_Amount_0_10                 FALSE integer    16</span>
<span class="co">#&gt; 17:          BP_Relaxing_0_10                 FALSE integer    17</span>
<span class="co">#&gt;     specified.from exclude.user.specified exclude.matches.outcome.name</span>
<span class="co">#&gt;  1:    input.names                  FALSE                        FALSE</span>
<span class="co">#&gt;  2:    input.names                  FALSE                        FALSE</span>
<span class="co">#&gt;  3:    input.names                  FALSE                        FALSE</span>
<span class="co">#&gt;  4:    input.names                  FALSE                        FALSE</span>
<span class="co">#&gt;  5:    input.names                  FALSE                        FALSE</span>
<span class="co">#&gt;  6:    input.names                     NA                        FALSE</span>
<span class="co">#&gt;  7: input.patterns                  FALSE                        FALSE</span>
<span class="co">#&gt;  8: input.patterns                  FALSE                        FALSE</span>
<span class="co">#&gt;  9: input.patterns                  FALSE                        FALSE</span>
<span class="co">#&gt; 10: input.patterns                  FALSE                        FALSE</span>
<span class="co">#&gt; 11: input.patterns                  FALSE                        FALSE</span>
<span class="co">#&gt; 12: input.patterns                  FALSE                        FALSE</span>
<span class="co">#&gt; 13: input.patterns                  FALSE                        FALSE</span>
<span class="co">#&gt; 14: input.patterns                  FALSE                        FALSE</span>
<span class="co">#&gt; 15: input.patterns                  FALSE                        FALSE</span>
<span class="co">#&gt; 16: input.patterns                  FALSE                        FALSE</span>
<span class="co">#&gt; 17: input.patterns                  FALSE                        FALSE</span>
<span class="co">#&gt;     include.variable</span>
<span class="co">#&gt;  1:             TRUE</span>
<span class="co">#&gt;  2:             TRUE</span>
<span class="co">#&gt;  3:             TRUE</span>
<span class="co">#&gt;  4:             TRUE</span>
<span class="co">#&gt;  5:             TRUE</span>
<span class="co">#&gt;  6:            FALSE</span>
<span class="co">#&gt;  7:             TRUE</span>
<span class="co">#&gt;  8:             TRUE</span>
<span class="co">#&gt;  9:             TRUE</span>
<span class="co">#&gt; 10:             TRUE</span>
<span class="co">#&gt; 11:             TRUE</span>
<span class="co">#&gt; 12:             TRUE</span>
<span class="co">#&gt; 13:             TRUE</span>
<span class="co">#&gt; 14:             TRUE</span>
<span class="co">#&gt; 15:             TRUE</span>
<span class="co">#&gt; 16:             TRUE</span>
<span class="co">#&gt; 17:             TRUE</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $interactions.table</span>
<span class="co">#&gt; Empty data.table (0 rows and 2 cols): interactions,include.interaction</span></code></pre></div>
<p>In this example, the age group was directly specified by the user. Gender was incorporated due to the first pattern, and then all of the brand perceptions were selected based on the second pattern, “BP_”.</p>
</div>
<div id="selecting-all-of-the-variables" class="section level3">
<h3 class="hasAnchor">
<a href="#selecting-all-of-the-variables" class="anchor"></a>Selecting All of the Variables</h3>
<p>The create.formula function maintains this capability when <strong>“.”</strong> is included in the input.names and a data set is provided:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dot.form.1</span> <span class="op">&lt;-</span>
  <span class="fu"><a href="../reference/create.formula.html">create.formula</a></span><span class="op">(</span>outcome.name <span class="op">=</span> <span class="va">outcome.name.awareness</span>,
                 input.names <span class="op">=</span> <span class="st">"."</span>,
                 dat <span class="op">=</span> <span class="va">snack.dat</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">dot.form.1</span><span class="op">)</span>
<span class="co">#&gt; $formula</span>
<span class="co">#&gt; Awareness ~ `User ID` + Age + Gender + Income + Region + Persona + </span>
<span class="co">#&gt;     Product + BP_For_Me_0_10 + BP_Fits_Budget_0_10 + BP_Tastes_Great_0_10 + </span>
<span class="co">#&gt;     BP_Good_To_Share_0_10 + BP_Like_Logo_0_10 + BP_Special_Occasions_0_10 + </span>
<span class="co">#&gt;     BP_Everyday_Snack_0_10 + BP_Healthy_0_10 + BP_Delicious_0_10 + </span>
<span class="co">#&gt;     BP_Right_Amount_0_10 + BP_Relaxing_0_10 + Consideration + </span>
<span class="co">#&gt;     Consumption + Satisfaction + Advocacy + `Age Group` + `Income Group`</span>
<span class="co">#&gt; &lt;environment: 0x0000000021f4f978&gt;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $inclusion.table</span>
<span class="co">#&gt;                      variable exclude.null.quantity   class order</span>
<span class="co">#&gt;  1:                   User ID                 FALSE  factor     1</span>
<span class="co">#&gt;  2:                       Age                 FALSE integer     2</span>
<span class="co">#&gt;  3:                    Gender                 FALSE  factor     3</span>
<span class="co">#&gt;  4:                    Income                 FALSE numeric     4</span>
<span class="co">#&gt;  5:                    Region                 FALSE  factor     5</span>
<span class="co">#&gt;  6:                   Persona                 FALSE  factor     6</span>
<span class="co">#&gt;  7:                   Product                 FALSE  factor     7</span>
<span class="co">#&gt;  8:                 Awareness                 FALSE integer     8</span>
<span class="co">#&gt;  9:            BP_For_Me_0_10                 FALSE integer     9</span>
<span class="co">#&gt; 10:       BP_Fits_Budget_0_10                 FALSE integer    10</span>
<span class="co">#&gt; 11:      BP_Tastes_Great_0_10                 FALSE integer    11</span>
<span class="co">#&gt; 12:     BP_Good_To_Share_0_10                 FALSE integer    12</span>
<span class="co">#&gt; 13:         BP_Like_Logo_0_10                 FALSE integer    13</span>
<span class="co">#&gt; 14: BP_Special_Occasions_0_10                 FALSE integer    14</span>
<span class="co">#&gt; 15:    BP_Everyday_Snack_0_10                 FALSE integer    15</span>
<span class="co">#&gt; 16:           BP_Healthy_0_10                 FALSE integer    16</span>
<span class="co">#&gt; 17:         BP_Delicious_0_10                 FALSE integer    17</span>
<span class="co">#&gt; 18:      BP_Right_Amount_0_10                 FALSE integer    18</span>
<span class="co">#&gt; 19:          BP_Relaxing_0_10                 FALSE integer    19</span>
<span class="co">#&gt; 20:             Consideration                 FALSE integer    20</span>
<span class="co">#&gt; 21:               Consumption                 FALSE integer    21</span>
<span class="co">#&gt; 22:              Satisfaction                 FALSE integer    22</span>
<span class="co">#&gt; 23:                  Advocacy                 FALSE integer    23</span>
<span class="co">#&gt; 24:                 Age Group                 FALSE  factor    24</span>
<span class="co">#&gt; 25:              Income Group                 FALSE  factor    25</span>
<span class="co">#&gt;                      variable exclude.null.quantity   class order</span>
<span class="co">#&gt;     specified.from exclude.user.specified exclude.matches.outcome.name</span>
<span class="co">#&gt;  1:    input.names                  FALSE                        FALSE</span>
<span class="co">#&gt;  2:    input.names                  FALSE                        FALSE</span>
<span class="co">#&gt;  3:    input.names                  FALSE                        FALSE</span>
<span class="co">#&gt;  4:    input.names                  FALSE                        FALSE</span>
<span class="co">#&gt;  5:    input.names                  FALSE                        FALSE</span>
<span class="co">#&gt;  6:    input.names                  FALSE                        FALSE</span>
<span class="co">#&gt;  7:    input.names                  FALSE                        FALSE</span>
<span class="co">#&gt;  8:    input.names                  FALSE                         TRUE</span>
<span class="co">#&gt;  9:    input.names                  FALSE                        FALSE</span>
<span class="co">#&gt; 10:    input.names                  FALSE                        FALSE</span>
<span class="co">#&gt; 11:    input.names                  FALSE                        FALSE</span>
<span class="co">#&gt; 12:    input.names                  FALSE                        FALSE</span>
<span class="co">#&gt; 13:    input.names                  FALSE                        FALSE</span>
<span class="co">#&gt; 14:    input.names                  FALSE                        FALSE</span>
<span class="co">#&gt; 15:    input.names                  FALSE                        FALSE</span>
<span class="co">#&gt; 16:    input.names                  FALSE                        FALSE</span>
<span class="co">#&gt; 17:    input.names                  FALSE                        FALSE</span>
<span class="co">#&gt; 18:    input.names                  FALSE                        FALSE</span>
<span class="co">#&gt; 19:    input.names                  FALSE                        FALSE</span>
<span class="co">#&gt; 20:    input.names                  FALSE                        FALSE</span>
<span class="co">#&gt; 21:    input.names                  FALSE                        FALSE</span>
<span class="co">#&gt; 22:    input.names                  FALSE                        FALSE</span>
<span class="co">#&gt; 23:    input.names                  FALSE                        FALSE</span>
<span class="co">#&gt; 24:    input.names                  FALSE                        FALSE</span>
<span class="co">#&gt; 25:    input.names                  FALSE                        FALSE</span>
<span class="co">#&gt;     specified.from exclude.user.specified exclude.matches.outcome.name</span>
<span class="co">#&gt;     include.variable</span>
<span class="co">#&gt;  1:             TRUE</span>
<span class="co">#&gt;  2:             TRUE</span>
<span class="co">#&gt;  3:             TRUE</span>
<span class="co">#&gt;  4:             TRUE</span>
<span class="co">#&gt;  5:             TRUE</span>
<span class="co">#&gt;  6:             TRUE</span>
<span class="co">#&gt;  7:             TRUE</span>
<span class="co">#&gt;  8:            FALSE</span>
<span class="co">#&gt;  9:             TRUE</span>
<span class="co">#&gt; 10:             TRUE</span>
<span class="co">#&gt; 11:             TRUE</span>
<span class="co">#&gt; 12:             TRUE</span>
<span class="co">#&gt; 13:             TRUE</span>
<span class="co">#&gt; 14:             TRUE</span>
<span class="co">#&gt; 15:             TRUE</span>
<span class="co">#&gt; 16:             TRUE</span>
<span class="co">#&gt; 17:             TRUE</span>
<span class="co">#&gt; 18:             TRUE</span>
<span class="co">#&gt; 19:             TRUE</span>
<span class="co">#&gt; 20:             TRUE</span>
<span class="co">#&gt; 21:             TRUE</span>
<span class="co">#&gt; 22:             TRUE</span>
<span class="co">#&gt; 23:             TRUE</span>
<span class="co">#&gt; 24:             TRUE</span>
<span class="co">#&gt; 25:             TRUE</span>
<span class="co">#&gt;     include.variable</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $interactions.table</span>
<span class="co">#&gt; Empty data.table (0 rows and 2 cols): interactions,include.interaction</span></code></pre></div>
<p>It is unnecessary, but user may want to add another variable as the following example demonstrates. create.formula will handle the duplicated variable, here “Gender”, and incorporate the variables that pass the quality checks:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">input.names</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Gender"</span>, <span class="st">"."</span><span class="op">)</span>

<span class="va">dot.form.2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create.formula.html">create.formula</a></span><span class="op">(</span>outcome.name <span class="op">=</span> <span class="va">outcome.name.awareness</span>, input.names <span class="op">=</span> <span class="va">input.names</span>, dat <span class="op">=</span> <span class="va">snack.dat</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">dot.form.2</span><span class="op">)</span>
<span class="co">#&gt; $formula</span>
<span class="co">#&gt; Awareness ~ Gender + `User ID` + Age + Income + Region + Persona + </span>
<span class="co">#&gt;     Product + BP_For_Me_0_10 + BP_Fits_Budget_0_10 + BP_Tastes_Great_0_10 + </span>
<span class="co">#&gt;     BP_Good_To_Share_0_10 + BP_Like_Logo_0_10 + BP_Special_Occasions_0_10 + </span>
<span class="co">#&gt;     BP_Everyday_Snack_0_10 + BP_Healthy_0_10 + BP_Delicious_0_10 + </span>
<span class="co">#&gt;     BP_Right_Amount_0_10 + BP_Relaxing_0_10 + Consideration + </span>
<span class="co">#&gt;     Consumption + Satisfaction + Advocacy + `Age Group` + `Income Group`</span>
<span class="co">#&gt; &lt;environment: 0x00000000221a1488&gt;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $inclusion.table</span>
<span class="co">#&gt;                      variable exclude.null.quantity   class order</span>
<span class="co">#&gt;  1:                    Gender                 FALSE  factor     1</span>
<span class="co">#&gt;  2:                   User ID                 FALSE  factor     2</span>
<span class="co">#&gt;  3:                       Age                 FALSE integer     3</span>
<span class="co">#&gt;  4:                    Income                 FALSE numeric     4</span>
<span class="co">#&gt;  5:                    Region                 FALSE  factor     5</span>
<span class="co">#&gt;  6:                   Persona                 FALSE  factor     6</span>
<span class="co">#&gt;  7:                   Product                 FALSE  factor     7</span>
<span class="co">#&gt;  8:                 Awareness                 FALSE integer     8</span>
<span class="co">#&gt;  9:            BP_For_Me_0_10                 FALSE integer     9</span>
<span class="co">#&gt; 10:       BP_Fits_Budget_0_10                 FALSE integer    10</span>
<span class="co">#&gt; 11:      BP_Tastes_Great_0_10                 FALSE integer    11</span>
<span class="co">#&gt; 12:     BP_Good_To_Share_0_10                 FALSE integer    12</span>
<span class="co">#&gt; 13:         BP_Like_Logo_0_10                 FALSE integer    13</span>
<span class="co">#&gt; 14: BP_Special_Occasions_0_10                 FALSE integer    14</span>
<span class="co">#&gt; 15:    BP_Everyday_Snack_0_10                 FALSE integer    15</span>
<span class="co">#&gt; 16:           BP_Healthy_0_10                 FALSE integer    16</span>
<span class="co">#&gt; 17:         BP_Delicious_0_10                 FALSE integer    17</span>
<span class="co">#&gt; 18:      BP_Right_Amount_0_10                 FALSE integer    18</span>
<span class="co">#&gt; 19:          BP_Relaxing_0_10                 FALSE integer    19</span>
<span class="co">#&gt; 20:             Consideration                 FALSE integer    20</span>
<span class="co">#&gt; 21:               Consumption                 FALSE integer    21</span>
<span class="co">#&gt; 22:              Satisfaction                 FALSE integer    22</span>
<span class="co">#&gt; 23:                  Advocacy                 FALSE integer    23</span>
<span class="co">#&gt; 24:                 Age Group                 FALSE  factor    24</span>
<span class="co">#&gt; 25:              Income Group                 FALSE  factor    25</span>
<span class="co">#&gt;                      variable exclude.null.quantity   class order</span>
<span class="co">#&gt;     specified.from exclude.user.specified exclude.matches.outcome.name</span>
<span class="co">#&gt;  1:    input.names                  FALSE                        FALSE</span>
<span class="co">#&gt;  2:    input.names                  FALSE                        FALSE</span>
<span class="co">#&gt;  3:    input.names                  FALSE                        FALSE</span>
<span class="co">#&gt;  4:    input.names                  FALSE                        FALSE</span>
<span class="co">#&gt;  5:    input.names                  FALSE                        FALSE</span>
<span class="co">#&gt;  6:    input.names                  FALSE                        FALSE</span>
<span class="co">#&gt;  7:    input.names                  FALSE                        FALSE</span>
<span class="co">#&gt;  8:    input.names                  FALSE                         TRUE</span>
<span class="co">#&gt;  9:    input.names                  FALSE                        FALSE</span>
<span class="co">#&gt; 10:    input.names                  FALSE                        FALSE</span>
<span class="co">#&gt; 11:    input.names                  FALSE                        FALSE</span>
<span class="co">#&gt; 12:    input.names                  FALSE                        FALSE</span>
<span class="co">#&gt; 13:    input.names                  FALSE                        FALSE</span>
<span class="co">#&gt; 14:    input.names                  FALSE                        FALSE</span>
<span class="co">#&gt; 15:    input.names                  FALSE                        FALSE</span>
<span class="co">#&gt; 16:    input.names                  FALSE                        FALSE</span>
<span class="co">#&gt; 17:    input.names                  FALSE                        FALSE</span>
<span class="co">#&gt; 18:    input.names                  FALSE                        FALSE</span>
<span class="co">#&gt; 19:    input.names                  FALSE                        FALSE</span>
<span class="co">#&gt; 20:    input.names                  FALSE                        FALSE</span>
<span class="co">#&gt; 21:    input.names                  FALSE                        FALSE</span>
<span class="co">#&gt; 22:    input.names                  FALSE                        FALSE</span>
<span class="co">#&gt; 23:    input.names                  FALSE                        FALSE</span>
<span class="co">#&gt; 24:    input.names                  FALSE                        FALSE</span>
<span class="co">#&gt; 25:    input.names                  FALSE                        FALSE</span>
<span class="co">#&gt;     specified.from exclude.user.specified exclude.matches.outcome.name</span>
<span class="co">#&gt;     include.variable</span>
<span class="co">#&gt;  1:             TRUE</span>
<span class="co">#&gt;  2:             TRUE</span>
<span class="co">#&gt;  3:             TRUE</span>
<span class="co">#&gt;  4:             TRUE</span>
<span class="co">#&gt;  5:             TRUE</span>
<span class="co">#&gt;  6:             TRUE</span>
<span class="co">#&gt;  7:             TRUE</span>
<span class="co">#&gt;  8:            FALSE</span>
<span class="co">#&gt;  9:             TRUE</span>
<span class="co">#&gt; 10:             TRUE</span>
<span class="co">#&gt; 11:             TRUE</span>
<span class="co">#&gt; 12:             TRUE</span>
<span class="co">#&gt; 13:             TRUE</span>
<span class="co">#&gt; 14:             TRUE</span>
<span class="co">#&gt; 15:             TRUE</span>
<span class="co">#&gt; 16:             TRUE</span>
<span class="co">#&gt; 17:             TRUE</span>
<span class="co">#&gt; 18:             TRUE</span>
<span class="co">#&gt; 19:             TRUE</span>
<span class="co">#&gt; 20:             TRUE</span>
<span class="co">#&gt; 21:             TRUE</span>
<span class="co">#&gt; 22:             TRUE</span>
<span class="co">#&gt; 23:             TRUE</span>
<span class="co">#&gt; 24:             TRUE</span>
<span class="co">#&gt; 25:             TRUE</span>
<span class="co">#&gt;     include.variable</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $interactions.table</span>
<span class="co">#&gt; Empty data.table (0 rows and 2 cols): interactions,include.interaction</span></code></pre></div>
<p>Also, if user adds another variable and misspells it that it is not a column name of the dataset as the following example shows, create.formula will drop the misspelled variable, here “Typo”, and incorporate the variables that pass the quality checks:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">input.names</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Typo"</span>, <span class="st">"."</span><span class="op">)</span>

<span class="va">dot.form.2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create.formula.html">create.formula</a></span><span class="op">(</span>outcome.name <span class="op">=</span> <span class="va">outcome.name.awareness</span>, input.names <span class="op">=</span> <span class="va">input.names</span>, dat <span class="op">=</span> <span class="va">snack.dat</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">dot.form.2</span><span class="op">)</span>
<span class="co">#&gt; $formula</span>
<span class="co">#&gt; Awareness ~ `User ID` + Age + Gender + Income + Region + Persona + </span>
<span class="co">#&gt;     Product + BP_For_Me_0_10 + BP_Fits_Budget_0_10 + BP_Tastes_Great_0_10 + </span>
<span class="co">#&gt;     BP_Good_To_Share_0_10 + BP_Like_Logo_0_10 + BP_Special_Occasions_0_10 + </span>
<span class="co">#&gt;     BP_Everyday_Snack_0_10 + BP_Healthy_0_10 + BP_Delicious_0_10 + </span>
<span class="co">#&gt;     BP_Right_Amount_0_10 + BP_Relaxing_0_10 + Consideration + </span>
<span class="co">#&gt;     Consumption + Satisfaction + Advocacy + `Age Group` + `Income Group`</span>
<span class="co">#&gt; &lt;environment: 0x0000000022317170&gt;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $inclusion.table</span>
<span class="co">#&gt;                      variable exclude.null.quantity   class order</span>
<span class="co">#&gt;  1:                      Typo                  TRUE    &lt;NA&gt;     1</span>
<span class="co">#&gt;  2:                   User ID                 FALSE  factor     2</span>
<span class="co">#&gt;  3:                       Age                 FALSE integer     3</span>
<span class="co">#&gt;  4:                    Gender                 FALSE  factor     4</span>
<span class="co">#&gt;  5:                    Income                 FALSE numeric     5</span>
<span class="co">#&gt;  6:                    Region                 FALSE  factor     6</span>
<span class="co">#&gt;  7:                   Persona                 FALSE  factor     7</span>
<span class="co">#&gt;  8:                   Product                 FALSE  factor     8</span>
<span class="co">#&gt;  9:                 Awareness                 FALSE integer     9</span>
<span class="co">#&gt; 10:            BP_For_Me_0_10                 FALSE integer    10</span>
<span class="co">#&gt; 11:       BP_Fits_Budget_0_10                 FALSE integer    11</span>
<span class="co">#&gt; 12:      BP_Tastes_Great_0_10                 FALSE integer    12</span>
<span class="co">#&gt; 13:     BP_Good_To_Share_0_10                 FALSE integer    13</span>
<span class="co">#&gt; 14:         BP_Like_Logo_0_10                 FALSE integer    14</span>
<span class="co">#&gt; 15: BP_Special_Occasions_0_10                 FALSE integer    15</span>
<span class="co">#&gt; 16:    BP_Everyday_Snack_0_10                 FALSE integer    16</span>
<span class="co">#&gt; 17:           BP_Healthy_0_10                 FALSE integer    17</span>
<span class="co">#&gt; 18:         BP_Delicious_0_10                 FALSE integer    18</span>
<span class="co">#&gt; 19:      BP_Right_Amount_0_10                 FALSE integer    19</span>
<span class="co">#&gt; 20:          BP_Relaxing_0_10                 FALSE integer    20</span>
<span class="co">#&gt; 21:             Consideration                 FALSE integer    21</span>
<span class="co">#&gt; 22:               Consumption                 FALSE integer    22</span>
<span class="co">#&gt; 23:              Satisfaction                 FALSE integer    23</span>
<span class="co">#&gt; 24:                  Advocacy                 FALSE integer    24</span>
<span class="co">#&gt; 25:                 Age Group                 FALSE  factor    25</span>
<span class="co">#&gt; 26:              Income Group                 FALSE  factor    26</span>
<span class="co">#&gt;                      variable exclude.null.quantity   class order</span>
<span class="co">#&gt;     specified.from exclude.user.specified exclude.matches.outcome.name</span>
<span class="co">#&gt;  1:    input.names                     NA                        FALSE</span>
<span class="co">#&gt;  2:    input.names                  FALSE                        FALSE</span>
<span class="co">#&gt;  3:    input.names                  FALSE                        FALSE</span>
<span class="co">#&gt;  4:    input.names                  FALSE                        FALSE</span>
<span class="co">#&gt;  5:    input.names                  FALSE                        FALSE</span>
<span class="co">#&gt;  6:    input.names                  FALSE                        FALSE</span>
<span class="co">#&gt;  7:    input.names                  FALSE                        FALSE</span>
<span class="co">#&gt;  8:    input.names                  FALSE                        FALSE</span>
<span class="co">#&gt;  9:    input.names                  FALSE                         TRUE</span>
<span class="co">#&gt; 10:    input.names                  FALSE                        FALSE</span>
<span class="co">#&gt; 11:    input.names                  FALSE                        FALSE</span>
<span class="co">#&gt; 12:    input.names                  FALSE                        FALSE</span>
<span class="co">#&gt; 13:    input.names                  FALSE                        FALSE</span>
<span class="co">#&gt; 14:    input.names                  FALSE                        FALSE</span>
<span class="co">#&gt; 15:    input.names                  FALSE                        FALSE</span>
<span class="co">#&gt; 16:    input.names                  FALSE                        FALSE</span>
<span class="co">#&gt; 17:    input.names                  FALSE                        FALSE</span>
<span class="co">#&gt; 18:    input.names                  FALSE                        FALSE</span>
<span class="co">#&gt; 19:    input.names                  FALSE                        FALSE</span>
<span class="co">#&gt; 20:    input.names                  FALSE                        FALSE</span>
<span class="co">#&gt; 21:    input.names                  FALSE                        FALSE</span>
<span class="co">#&gt; 22:    input.names                  FALSE                        FALSE</span>
<span class="co">#&gt; 23:    input.names                  FALSE                        FALSE</span>
<span class="co">#&gt; 24:    input.names                  FALSE                        FALSE</span>
<span class="co">#&gt; 25:    input.names                  FALSE                        FALSE</span>
<span class="co">#&gt; 26:    input.names                  FALSE                        FALSE</span>
<span class="co">#&gt;     specified.from exclude.user.specified exclude.matches.outcome.name</span>
<span class="co">#&gt;     include.variable</span>
<span class="co">#&gt;  1:            FALSE</span>
<span class="co">#&gt;  2:             TRUE</span>
<span class="co">#&gt;  3:             TRUE</span>
<span class="co">#&gt;  4:             TRUE</span>
<span class="co">#&gt;  5:             TRUE</span>
<span class="co">#&gt;  6:             TRUE</span>
<span class="co">#&gt;  7:             TRUE</span>
<span class="co">#&gt;  8:             TRUE</span>
<span class="co">#&gt;  9:            FALSE</span>
<span class="co">#&gt; 10:             TRUE</span>
<span class="co">#&gt; 11:             TRUE</span>
<span class="co">#&gt; 12:             TRUE</span>
<span class="co">#&gt; 13:             TRUE</span>
<span class="co">#&gt; 14:             TRUE</span>
<span class="co">#&gt; 15:             TRUE</span>
<span class="co">#&gt; 16:             TRUE</span>
<span class="co">#&gt; 17:             TRUE</span>
<span class="co">#&gt; 18:             TRUE</span>
<span class="co">#&gt; 19:             TRUE</span>
<span class="co">#&gt; 20:             TRUE</span>
<span class="co">#&gt; 21:             TRUE</span>
<span class="co">#&gt; 22:             TRUE</span>
<span class="co">#&gt; 23:             TRUE</span>
<span class="co">#&gt; 24:             TRUE</span>
<span class="co">#&gt; 25:             TRUE</span>
<span class="co">#&gt; 26:             TRUE</span>
<span class="co">#&gt;     include.variable</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $interactions.table</span>
<span class="co">#&gt; Empty data.table (0 rows and 2 cols): interactions,include.interaction</span></code></pre></div>
</div>
<div id="removing-specific-variables" class="section level3">
<h3 class="hasAnchor">
<a href="#removing-specific-variables" class="anchor"></a>Removing Specific Variables</h3>
<p>With multiple ways to specify the variables to include in a formula, it can also be helpful to ensure that a specific variable may not be included. As an example, when utilizing the input.patterns to include all of the brand perception variables, we can specifically remove BP_Delicious_0_10 and Gender by specifying the <strong>variables.to.exclude</strong> parameter. The parameter supersedes any variables mentioned in input.names as well as interactions:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">input.names</span> <span class="op">&lt;-</span>
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Age"</span>,
    <span class="st">"Gender"</span>,
    <span class="st">"Income"</span>,
    <span class="st">"Region"</span>,
    <span class="st">"Persona"</span>,
    <span class="st">"Typo"</span>,
    <span class="st">"Age Group"</span><span class="op">)</span>
<span class="va">interactions</span> <span class="op">&lt;-</span>
  <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
    <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Age"</span>, <span class="st">"Gender"</span><span class="op">)</span>,
    <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Age"</span>, <span class="st">"Income"</span><span class="op">)</span>,
    <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Age"</span>, <span class="st">"Gender"</span>, <span class="st">"Income"</span><span class="op">)</span>,
    <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Gender"</span>, <span class="st">"Inco"</span><span class="op">)</span>,
    <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Age"</span>, <span class="st">"Reg ion"</span><span class="op">)</span>
  <span class="op">)</span>
<span class="va">bp.pattern</span> <span class="op">=</span> <span class="st">"BP_"</span>
<span class="va">variables.to.exclude</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"BP_Delicious_0_10"</span>, <span class="st">"Gender"</span><span class="op">)</span>

<span class="va">variables.to.exclude.form</span> <span class="op">&lt;-</span>
  <span class="fu"><a href="../reference/create.formula.html">create.formula</a></span><span class="op">(</span>
    outcome.name <span class="op">=</span> <span class="va">outcome.name.awareness</span>,
    input.names <span class="op">=</span> <span class="va">input.names</span>,
    interactions <span class="op">=</span> <span class="va">interactions</span>,
    input.patterns <span class="op">=</span> <span class="va">bp.pattern</span>,
    variables.to.exclude <span class="op">=</span> <span class="va">variables.to.exclude</span>,
    dat <span class="op">=</span> <span class="va">snack.dat</span>
  <span class="op">)</span>


<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">variables.to.exclude.form</span><span class="op">)</span>
<span class="co">#&gt; $formula</span>
<span class="co">#&gt; Awareness ~ Age + Income + Region + Persona + `Age Group` + BP_For_Me_0_10 + </span>
<span class="co">#&gt;     BP_Fits_Budget_0_10 + BP_Tastes_Great_0_10 + BP_Good_To_Share_0_10 + </span>
<span class="co">#&gt;     BP_Like_Logo_0_10 + BP_Special_Occasions_0_10 + BP_Everyday_Snack_0_10 + </span>
<span class="co">#&gt;     BP_Healthy_0_10 + BP_Right_Amount_0_10 + BP_Relaxing_0_10 + </span>
<span class="co">#&gt;     Age * Income</span>
<span class="co">#&gt; &lt;environment: 0x0000000020eed690&gt;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $inclusion.table</span>
<span class="co">#&gt;                      variable exclude.null.quantity   class order</span>
<span class="co">#&gt;  1:                       Age                 FALSE integer     1</span>
<span class="co">#&gt;  2:                    Gender                 FALSE  factor     2</span>
<span class="co">#&gt;  3:                    Income                 FALSE numeric     3</span>
<span class="co">#&gt;  4:                    Region                 FALSE  factor     4</span>
<span class="co">#&gt;  5:                   Persona                 FALSE  factor     5</span>
<span class="co">#&gt;  6:                      Typo                  TRUE    &lt;NA&gt;     6</span>
<span class="co">#&gt;  7:                 Age Group                 FALSE  factor     7</span>
<span class="co">#&gt;  8:            BP_For_Me_0_10                 FALSE integer     8</span>
<span class="co">#&gt;  9:       BP_Fits_Budget_0_10                 FALSE integer     9</span>
<span class="co">#&gt; 10:      BP_Tastes_Great_0_10                 FALSE integer    10</span>
<span class="co">#&gt; 11:     BP_Good_To_Share_0_10                 FALSE integer    11</span>
<span class="co">#&gt; 12:         BP_Like_Logo_0_10                 FALSE integer    12</span>
<span class="co">#&gt; 13: BP_Special_Occasions_0_10                 FALSE integer    13</span>
<span class="co">#&gt; 14:    BP_Everyday_Snack_0_10                 FALSE integer    14</span>
<span class="co">#&gt; 15:           BP_Healthy_0_10                 FALSE integer    15</span>
<span class="co">#&gt; 16:         BP_Delicious_0_10                 FALSE integer    16</span>
<span class="co">#&gt; 17:      BP_Right_Amount_0_10                 FALSE integer    17</span>
<span class="co">#&gt; 18:          BP_Relaxing_0_10                 FALSE integer    18</span>
<span class="co">#&gt; 19:                      Inco                  TRUE    &lt;NA&gt;    19</span>
<span class="co">#&gt; 20:                   Reg ion                  TRUE    &lt;NA&gt;    20</span>
<span class="co">#&gt;     specified.from exclude.user.specified exclude.matches.outcome.name</span>
<span class="co">#&gt;  1:    input.names                  FALSE                        FALSE</span>
<span class="co">#&gt;  2:    input.names                   TRUE                        FALSE</span>
<span class="co">#&gt;  3:    input.names                  FALSE                        FALSE</span>
<span class="co">#&gt;  4:    input.names                  FALSE                        FALSE</span>
<span class="co">#&gt;  5:    input.names                  FALSE                        FALSE</span>
<span class="co">#&gt;  6:    input.names                     NA                        FALSE</span>
<span class="co">#&gt;  7:    input.names                  FALSE                        FALSE</span>
<span class="co">#&gt;  8: input.patterns                  FALSE                        FALSE</span>
<span class="co">#&gt;  9: input.patterns                  FALSE                        FALSE</span>
<span class="co">#&gt; 10: input.patterns                  FALSE                        FALSE</span>
<span class="co">#&gt; 11: input.patterns                  FALSE                        FALSE</span>
<span class="co">#&gt; 12: input.patterns                  FALSE                        FALSE</span>
<span class="co">#&gt; 13: input.patterns                  FALSE                        FALSE</span>
<span class="co">#&gt; 14: input.patterns                  FALSE                        FALSE</span>
<span class="co">#&gt; 15: input.patterns                  FALSE                        FALSE</span>
<span class="co">#&gt; 16: input.patterns                   TRUE                        FALSE</span>
<span class="co">#&gt; 17: input.patterns                  FALSE                        FALSE</span>
<span class="co">#&gt; 18: input.patterns                  FALSE                        FALSE</span>
<span class="co">#&gt; 19:   interactions                     NA                        FALSE</span>
<span class="co">#&gt; 20:   interactions                     NA                        FALSE</span>
<span class="co">#&gt;     include.variable</span>
<span class="co">#&gt;  1:             TRUE</span>
<span class="co">#&gt;  2:            FALSE</span>
<span class="co">#&gt;  3:             TRUE</span>
<span class="co">#&gt;  4:             TRUE</span>
<span class="co">#&gt;  5:             TRUE</span>
<span class="co">#&gt;  6:            FALSE</span>
<span class="co">#&gt;  7:             TRUE</span>
<span class="co">#&gt;  8:             TRUE</span>
<span class="co">#&gt;  9:             TRUE</span>
<span class="co">#&gt; 10:             TRUE</span>
<span class="co">#&gt; 11:             TRUE</span>
<span class="co">#&gt; 12:             TRUE</span>
<span class="co">#&gt; 13:             TRUE</span>
<span class="co">#&gt; 14:             TRUE</span>
<span class="co">#&gt; 15:             TRUE</span>
<span class="co">#&gt; 16:            FALSE</span>
<span class="co">#&gt; 17:             TRUE</span>
<span class="co">#&gt; 18:             TRUE</span>
<span class="co">#&gt; 19:            FALSE</span>
<span class="co">#&gt; 20:            FALSE</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $interactions.table</span>
<span class="co">#&gt;             interactions include.interaction</span>
<span class="co">#&gt; 1:          Age * Gender               FALSE</span>
<span class="co">#&gt; 2:          Age * Income                TRUE</span>
<span class="co">#&gt; 3: Age * Gender * Income               FALSE</span>
<span class="co">#&gt; 4:         Gender * Inco               FALSE</span>
<span class="co">#&gt; 5:         Age * Reg ion               FALSE</span></code></pre></div>
</div>
<div id="quality-checks" class="section level3">
<h3 class="hasAnchor">
<a href="#quality-checks" class="anchor"></a>Quality Checks</h3>
<p>With the create.formula function, the formulaic package devises a range of quality checks that investigate the design of a formula. The degree of quality checks can be controlled by the user at several levels. When the user specifies that quality checks should be performed, the create.formula method builds objects called <strong>inclusion.table</strong> and <strong>interactions.table</strong>, which form a portion of the method’s output. The inclusion.table object is a data.frame that reports on each variable that was considered for inclusion in the final list of inputs. Ultimately, the inclusion.table object will include a variety of columns, one for each quality check, that each indicates whether a variable should be excluded. Once all of the specified quality checks have been performed, the include.variable column is computed as an overall indicator of whether the specified variable should be included as an input in the formula object.</p>
<p>The interactions.table follows a similar logic. An interaction will be excluded if any of the variables in its components was excluded based on the quality checks in the inclusion.table.</p>
</div>
<div id="outcomes-as-inputs" class="section level3">
<h3 class="hasAnchor">
<a href="#outcomes-as-inputs" class="anchor"></a>Outcomes as Inputs</h3>
<p>Most formula objects would not include the outcome variable as an input. However, when such a formula is constructed, whether by mistake or with intention, there is a lack of consistency is the way many common models handle the issue(outcomes as inputs situation). For instance, <strong>Income ~ Age + Income</strong>. The function drops the outcome variable in inputs automatically, and return the formula as followed: <strong>Income ~ Age</strong>.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">input.names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Income"</span>, <span class="st">"Age"</span>, <span class="st">"Income"</span><span class="op">)</span>
<span class="va">income.name</span> <span class="op">=</span> <span class="st">"Income"</span>

<span class="va">outcomes.as.inputs.form</span> <span class="op">&lt;-</span>
  <span class="fu"><a href="../reference/create.formula.html">create.formula</a></span><span class="op">(</span>outcome.name <span class="op">=</span> <span class="va">income.name</span>,
                 input.names <span class="op">=</span> <span class="va">input.names</span>,
                 dat <span class="op">=</span> <span class="va">snack.dat</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">outcomes.as.inputs.form</span><span class="op">)</span>
<span class="co">#&gt; $formula</span>
<span class="co">#&gt; Income ~ Age</span>
<span class="co">#&gt; &lt;environment: 0x0000000021adccf8&gt;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $inclusion.table</span>
<span class="co">#&gt;    variable exclude.null.quantity   class order specified.from</span>
<span class="co">#&gt; 1:   Income                 FALSE numeric     1    input.names</span>
<span class="co">#&gt; 2:      Age                 FALSE integer     2    input.names</span>
<span class="co">#&gt;    exclude.user.specified exclude.matches.outcome.name include.variable</span>
<span class="co">#&gt; 1:                  FALSE                         TRUE            FALSE</span>
<span class="co">#&gt; 2:                  FALSE                        FALSE             TRUE</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $interactions.table</span>
<span class="co">#&gt; Empty data.table (0 rows and 2 cols): interactions,include.interaction</span></code></pre></div>
</div>
<div id="removing-duplicated-variables" class="section level3">
<h3 class="hasAnchor">
<a href="#removing-duplicated-variables" class="anchor"></a>Removing duplicated variables</h3>
<p>There is a chance that users accidentally or intentionally add the same variable more than once in input, which we call duplicated variables. The create.formula will build formula with the unique variable names into the formula:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">duplicated.inputs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep.int</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Age"</span>, times <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>, <span class="st">"Income"</span><span class="op">)</span>
<span class="va">duplicated.interactions</span> <span class="op">&lt;-</span>
  <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Age"</span>, <span class="st">"Income"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Age"</span>, <span class="st">"Income"</span><span class="op">)</span><span class="op">)</span>

<span class="va">duplicated.form</span> <span class="op">&lt;-</span>
  <span class="fu"><a href="../reference/create.formula.html">create.formula</a></span><span class="op">(</span>
    outcome.name <span class="op">=</span> <span class="va">outcome.name.awareness</span>,
    input.names <span class="op">=</span> <span class="va">duplicated.inputs</span>,
    interactions <span class="op">=</span> <span class="va">duplicated.interactions</span>,
    dat <span class="op">=</span> <span class="va">snack.dat</span>
  <span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">duplicated.form</span><span class="op">)</span>
<span class="co">#&gt; $formula</span>
<span class="co">#&gt; Awareness ~ Age + Income + Age * Income</span>
<span class="co">#&gt; &lt;environment: 0x000000002109b968&gt;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $inclusion.table</span>
<span class="co">#&gt;    variable exclude.null.quantity   class order specified.from</span>
<span class="co">#&gt; 1:      Age                 FALSE integer     1    input.names</span>
<span class="co">#&gt; 2:   Income                 FALSE numeric     2    input.names</span>
<span class="co">#&gt;    exclude.user.specified exclude.matches.outcome.name include.variable</span>
<span class="co">#&gt; 1:                  FALSE                        FALSE             TRUE</span>
<span class="co">#&gt; 2:                  FALSE                        FALSE             TRUE</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $interactions.table</span>
<span class="co">#&gt;    interactions include.interaction</span>
<span class="co">#&gt; 1: Age * Income                TRUE</span></code></pre></div>
</div>
<div id="misspecified-variables" class="section level3">
<h3 class="hasAnchor">
<a href="#misspecified-variables" class="anchor"></a>Misspecified Variables</h3>
<p>A formula object in R can only be supplied to a model when all of its terms directly match the names of the data.frame object on which the model will be fit. Misspecified variables within a formula, such as those arising from typographical errors, will typically lead to error messages in R’s implementation of a model. The formulaic package provides the option to either a) maintain this effect or b) automatically remove any misspecified variables. When a user supplies a dataset to the create.formula function, the variables intended for the formula receive a quality check to ensure that they match a corresponding name within the associated data.frame. Misspecified variables will be marked in the inclusion.table portion of the output of the create.formula function. Any misspecified variables or associated interactions will be removed from the formula in this setting.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">input.names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Age"</span>, <span class="st">"Typo"</span><span class="op">)</span>
<span class="va">income.name</span> <span class="op">&lt;-</span> <span class="st">"Income"</span>

<span class="va">formula.with.typo</span> <span class="op">&lt;-</span>
  <span class="fu"><a href="../reference/create.formula.html">create.formula</a></span><span class="op">(</span>outcome.name <span class="op">=</span> <span class="va">income.name</span>, input.names <span class="op">=</span> <span class="va">input.names</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">formula.with.typo</span><span class="op">)</span>
<span class="co">#&gt; $formula</span>
<span class="co">#&gt; Income ~ Age + Typo</span>
<span class="co">#&gt; &lt;environment: 0x000000002346c758&gt;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $inclusion.table</span>
<span class="co">#&gt; Null data.table (0 rows and 0 cols)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $interactions.table</span>
<span class="co">#&gt; Null data.table (0 rows and 0 cols)</span></code></pre></div>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">formula.without.typo</span> <span class="op">&lt;-</span>
  <span class="fu"><a href="../reference/create.formula.html">create.formula</a></span><span class="op">(</span>outcome.name <span class="op">=</span> <span class="va">income.name</span>,
                 input.names <span class="op">=</span> <span class="va">input.names</span>,
                 dat <span class="op">=</span> <span class="va">snack.dat</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">formula.without.typo</span><span class="op">)</span>
<span class="co">#&gt; $formula</span>
<span class="co">#&gt; Income ~ Age</span>
<span class="co">#&gt; &lt;environment: 0x0000000023849cb0&gt;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $inclusion.table</span>
<span class="co">#&gt;    variable exclude.null.quantity   class order specified.from</span>
<span class="co">#&gt; 1:      Age                 FALSE integer     1    input.names</span>
<span class="co">#&gt; 2:     Typo                  TRUE    &lt;NA&gt;     2    input.names</span>
<span class="co">#&gt;    exclude.user.specified exclude.matches.outcome.name include.variable</span>
<span class="co">#&gt; 1:                  FALSE                        FALSE             TRUE</span>
<span class="co">#&gt; 2:                     NA                        FALSE            FALSE</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $interactions.table</span>
<span class="co">#&gt; Empty data.table (0 rows and 2 cols): interactions,include.interaction</span></code></pre></div>
</div>
<div id="considerations-for-feature-engineering" class="section level3">
<h3 class="hasAnchor">
<a href="#considerations-for-feature-engineering" class="anchor"></a>Considerations for Feature Engineering</h3>
<p>Selecting appropriate variables for a statistical model can include challenges associated with the domain, methodology, computational considerations, and practical limitations of the data. Some variables may not be suitable for inclusion based on either a lack of contrast or a large number of categories. This section will explore these problems in greater detail. In doing so, we will demonstrate how the formulaic package can automatically identify and handle these issues.</p>
</div>
<div id="a-lack-of-contrast" class="section level3">
<h3 class="hasAnchor">
<a href="#a-lack-of-contrast" class="anchor"></a>A Lack of Contrast</h3>
<p>Statistical models typically estimate the relationship between outcome and the inputs based upon the impact of changes in the inputs. When a variable is constant across all of its measured values, its variance is zero, and therefore the variable’s correlation with another variable is undefined. A constant input variable therefore exhibits a lack of contrast with regard to estimating its impact on an outcome. Many statistical models in R will return error messages when an input is a constant variable or consists only of missing data. If a large number of variables are included, then each error message will <strong>only identify the first such variable</strong>. An iterative process may be required to remove variables with a lack of contrast. Furthermore, even in variables that exhibit variation across the full range of the data, a lack of contrast may yet arise when a model is fit on a subset of these data.</p>
</div>
<div id="numeric-variables-with-no-variation" class="section level3">
<h3 class="hasAnchor">
<a href="#numeric-variables-with-no-variation" class="anchor"></a>Numeric Variables With No Variation</h3>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">snack.dat</span><span class="op">[</span>, <span class="va">.N</span>, keyby <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Awareness"</span>, <span class="st">"Consideration"</span><span class="op">)</span><span class="op">]</span>
<span class="co">#&gt;    Awareness Consideration     N</span>
<span class="co">#&gt; 1:         0            NA 10906</span>
<span class="co">#&gt; 2:         1             0  6907</span>
<span class="co">#&gt; 3:         1             1  5187</span></code></pre></div>
<p>A model of consideration, estimated on the rows for which this outcome is measured, would therefore only include values of 1 for the respondents’ awareness. A logistic regression that includes awareness as an input would therefore generate a missing value for the coefficient of awareness:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">formula.consideration</span> <span class="op">&lt;-</span>
  <span class="fu"><a href="../reference/create.formula.html">create.formula</a></span><span class="op">(</span>outcome.name <span class="op">=</span> <span class="va">consideration.name</span>,
                 input.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">age.name</span>, <span class="va">awareness.name</span><span class="op">)</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">formula.consideration</span><span class="op">$</span><span class="va">formula</span><span class="op">)</span>
<span class="co">#&gt; Consideration ~ Age + Awareness</span>
<span class="co">#&gt; &lt;environment: 0x000000001953e6a0&gt;</span>

<span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">formula.consideration</span>,
    data <span class="op">=</span> <span class="va">snack.dat</span>,
    family <span class="op">=</span> <span class="st">"binomial"</span><span class="op">)</span><span class="op">$</span><span class="va">coefficients</span>
<span class="co">#&gt;   (Intercept)           Age     Awareness </span>
<span class="co">#&gt; -0.2556379284 -0.0005580826            NA</span></code></pre></div>
<p>Because the awareness variable <strong>lacks variation</strong> in this subset, it is not suitable for use as a predictor of consideration. (It should instead be viewed as a prerequisite.) This matter can be resolved through the use of the <strong>reduce parameter</strong> in the create.formula function. When reduce = TRUE and a dataset is provided for inspection, create.formula automatically performs quality checks on all of the potential input variables. Any variables with a lack of variation will be identified and proactively excluded from the formula. Meanwhile, a record of this inspection is provided in the inclusion.table’s output:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">formula.consideration</span> <span class="op">&lt;-</span>
  <span class="fu"><a href="../reference/create.formula.html">create.formula</a></span><span class="op">(</span>
    outcome.name <span class="op">=</span> <span class="va">consideration.name</span>,
    input.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">age.name</span>, <span class="va">awareness.name</span><span class="op">)</span>,
    dat <span class="op">=</span> <span class="va">snack.dat</span>,
    reduce <span class="op">=</span> <span class="cn">TRUE</span>
  <span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">formula.consideration</span><span class="op">)</span>
<span class="co">#&gt; $formula</span>
<span class="co">#&gt; Consideration ~ Age</span>
<span class="co">#&gt; &lt;environment: 0x0000000018a3c8e0&gt;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $inclusion.table</span>
<span class="co">#&gt;     variable exclude.null.quantity   class order specified.from</span>
<span class="co">#&gt; 1:       Age                 FALSE integer     1    input.names</span>
<span class="co">#&gt; 2: Awareness                 FALSE integer     2    input.names</span>
<span class="co">#&gt;    exclude.user.specified exclude.matches.outcome.name min.categories</span>
<span class="co">#&gt; 1:                  FALSE                        FALSE             75</span>
<span class="co">#&gt; 2:                  FALSE                        FALSE              1</span>
<span class="co">#&gt;    exclude.lack.contrast exclude.numerous.categories include.variable</span>
<span class="co">#&gt; 1:                 FALSE                       FALSE             TRUE</span>
<span class="co">#&gt; 2:                  TRUE                       FALSE            FALSE</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $interactions.table</span>
<span class="co">#&gt; Empty data.table (0 rows and 2 cols): interactions,include.interaction</span></code></pre></div>
</div>
<div id="categorical-variables-with-no-variation" class="section level3">
<h3 class="hasAnchor">
<a href="#categorical-variables-with-no-variation" class="anchor"></a>Categorical Variables With No Variation</h3>
<p>To incorporate categorical variables with k &gt; 1 different measured values, statistical models typically code separate columns of indicator variables across k-1 categories, while the kth category serves as a reference. Without variation (k &lt;= 1), this procedure cannot code any indicator variables. Without a meaningful way to include such a variable as an input, the model will instead generate an error message.</p>
<p>As an example, consider a model generated on the subset of respondents between the ages of 18 and 35 years old. This represents one category of the possible age groups. If a logistic regression model nonetheless attempted to include the age group as an input, this would lead to the following result:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">formula.awareness</span> <span class="op">&lt;-</span>
  <span class="fu"><a href="../reference/create.formula.html">create.formula</a></span><span class="op">(</span>outcome.name <span class="op">=</span> <span class="va">awareness.name</span>,
                 input.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">age.group.name</span>, <span class="va">gender.name</span><span class="op">)</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">formula.awareness</span><span class="op">$</span><span class="va">formula</span><span class="op">)</span>
<span class="co">#&gt; Awareness ~ `Age Group` + Gender</span>
<span class="co">#&gt; &lt;environment: 0x00000000217d4158&gt;</span></code></pre></div>
<p>#<code>{r create.formula with lack of contrast 1} #glm(formula = formula.awareness$formula, data = #snack.dat[get(age.group.name) == "[ 18, 35)",], family = "binomial") #</code></p>
<p>This particular example is designed to demonstrate the issue with a simple contradiction, and its root cause is easy to identify. In real applications, significant investigation may be required to determine which variables may be causing such an effect. The error message provided informs the user of a lack of contrast, but it does not identify which variable is causing the issue. In a formula that incorporates many inputs, there may be a number of different variables that each contribute to the issue.</p>
<p>Within the formulaic package, the create.formula’s <strong>reduce</strong> parameter can be used to automatically identify categorical variables with a lack of contrast. When <strong>reduce = TRUE</strong> and a data set is provided, inputs with no variation are excluded from the resulting formula. The <strong>exclude.lack.contrast </strong> column of the output’s <strong>inclusion.table</strong> identifies which variables include a lack of contrast, and the <strong>min.categories</strong> column identifies the number of unique values for each variable. This is demonstrated with the call to create.formula below:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R">

<span class="va">formula.awareness</span> <span class="op">&lt;-</span>
  <span class="fu"><a href="../reference/create.formula.html">create.formula</a></span><span class="op">(</span>
    outcome.name <span class="op">=</span> <span class="va">awareness.name</span>,
    input.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">age.group.name</span>, <span class="va">gender.name</span><span class="op">)</span>,
    dat <span class="op">=</span> <span class="va">snack.dat</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/get.html">get</a></span><span class="op">(</span><span class="va">age.group.name</span><span class="op">)</span> <span class="op">==</span> <span class="st">"[ 18, 35)"</span>, <span class="op">]</span>,
    reduce <span class="op">=</span> <span class="cn">TRUE</span>
  <span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">formula.awareness</span><span class="op">)</span></code></pre></div>
</div>
<div id="a-lack-of-contrast-within-subsets-of-the-data" class="section level3">
<h3 class="hasAnchor">
<a href="#a-lack-of-contrast-within-subsets-of-the-data" class="anchor"></a>A Lack of Contrast within Subsets of the Data</h3>
<p>Due to the snack.dat’s series of survey questions, many of the measured variables for a brand are recorded downstream from the initial question about the respondent’s awareness. These questions are only asked to the respondents who indicate awareness. As shown previously, the values of consideration (1 or 0) only occur when awareness is equal to 1. Across the full range of the data, the consideration variable includes multiple values and exhibits variation. However, within the subgroup of respondents who are not aware of the specific product, all of the values are missing. Due to this structurally missing design, it can be necessary to search for a lack of contrast within subsets of the outcome variable. The create.formula function allows the users to specify the <strong>max.outcome.categories.to.search</strong>. When the number of unique values of the outcome is less than or equal to the value of max.outcome.categories.to.search, a data set is provided, and reduce = TRUE, then the search for a lack of contrast is extended into the subsets based on the outcome variable.</p>
<p>As an example, consider a model of consideration that attempts to utilize awareness as an input. The consideration outcome has two unique measured values (1 and 0). If <strong>max.outcome.categories.to.search = 1</strong>, then the subgroups of consideration will <strong>not</strong> be searched for a lack of contrast. Instead, the only quality check related to variation will examine each variable for a <strong>global lack of contrast</strong>. In the case of awareness, it exhibits variation at the global level with binary outcomes. This selection is depicted below:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">formula.consideration.1</span> <span class="op">&lt;-</span>
  <span class="fu"><a href="../reference/create.formula.html">create.formula</a></span><span class="op">(</span>
    outcome.name <span class="op">=</span> <span class="va">consideration.name</span>,
    input.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">age.group.name</span>, <span class="va">gender.name</span>, <span class="va">awareness.name</span><span class="op">)</span>,
    dat <span class="op">=</span> <span class="va">snack.dat</span>,
    reduce <span class="op">=</span> <span class="cn">TRUE</span>,
    max.outcome.categories.to.search <span class="op">=</span> <span class="fl">1</span>
  <span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">formula.consideration.1</span><span class="op">)</span>
<span class="co">#&gt; $formula</span>
<span class="co">#&gt; Consideration ~ `Age Group` + Gender + Awareness</span>
<span class="co">#&gt; &lt;environment: 0x0000000021bd22e0&gt;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $inclusion.table</span>
<span class="co">#&gt;     variable exclude.null.quantity   class order specified.from</span>
<span class="co">#&gt; 1: Age Group                 FALSE  factor     1    input.names</span>
<span class="co">#&gt; 2:    Gender                 FALSE  factor     2    input.names</span>
<span class="co">#&gt; 3: Awareness                 FALSE integer     3    input.names</span>
<span class="co">#&gt;    exclude.user.specified exclude.matches.outcome.name min.categories</span>
<span class="co">#&gt; 1:                  FALSE                        FALSE              4</span>
<span class="co">#&gt; 2:                  FALSE                        FALSE              2</span>
<span class="co">#&gt; 3:                  FALSE                        FALSE              2</span>
<span class="co">#&gt;    exclude.lack.contrast exclude.numerous.categories include.variable</span>
<span class="co">#&gt; 1:                 FALSE                       FALSE             TRUE</span>
<span class="co">#&gt; 2:                 FALSE                       FALSE             TRUE</span>
<span class="co">#&gt; 3:                 FALSE                       FALSE             TRUE</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $interactions.table</span>
<span class="co">#&gt; Empty data.table (0 rows and 2 cols): interactions,include.interaction</span></code></pre></div>
<p>However, if <strong>max.outcome.categories.to.search &gt;= 2</strong>, then the consideration variable would qualify as having sufficiently few unique values. Then each subset would subsequently be searched for a lack of contrast in each of the possible inputs. When consideration is 1 or 0, the awareness variable is always 1. Therefore, the inclusion.table’s calculation of the <strong>min.categories</strong> will be reduced from 2 (in the prior example) to 1 (below). As a result, the exclude.lack.contrast entry for the awareness variable will be flipped from FALSE to TRUE, and awareness will be removed from the formula.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">formula.consideration.2</span> <span class="op">&lt;-</span>
  <span class="fu"><a href="../reference/create.formula.html">create.formula</a></span><span class="op">(</span>
    outcome.name <span class="op">=</span> <span class="va">consideration.name</span>,
    input.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">age.group.name</span>, <span class="va">gender.name</span>, <span class="va">awareness.name</span><span class="op">)</span>,
    dat <span class="op">=</span> <span class="va">snack.dat</span>,
    reduce <span class="op">=</span> <span class="cn">TRUE</span>,
    max.outcome.categories.to.search <span class="op">=</span> <span class="fl">2</span>
  <span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">formula.consideration.2</span><span class="op">)</span>
<span class="co">#&gt; $formula</span>
<span class="co">#&gt; Consideration ~ `Age Group` + Gender</span>
<span class="co">#&gt; &lt;environment: 0x00000000190ae7d0&gt;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $inclusion.table</span>
<span class="co">#&gt;     variable exclude.null.quantity   class order specified.from</span>
<span class="co">#&gt; 1: Age Group                 FALSE  factor     1    input.names</span>
<span class="co">#&gt; 2:    Gender                 FALSE  factor     2    input.names</span>
<span class="co">#&gt; 3: Awareness                 FALSE integer     3    input.names</span>
<span class="co">#&gt;    exclude.user.specified exclude.matches.outcome.name min.categories</span>
<span class="co">#&gt; 1:                  FALSE                        FALSE              4</span>
<span class="co">#&gt; 2:                  FALSE                        FALSE              2</span>
<span class="co">#&gt; 3:                  FALSE                        FALSE              1</span>
<span class="co">#&gt;    exclude.lack.contrast exclude.numerous.categories include.variable</span>
<span class="co">#&gt; 1:                 FALSE                       FALSE             TRUE</span>
<span class="co">#&gt; 2:                 FALSE                       FALSE             TRUE</span>
<span class="co">#&gt; 3:                  TRUE                       FALSE            FALSE</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $interactions.table</span>
<span class="co">#&gt; Empty data.table (0 rows and 2 cols): interactions,include.interaction</span></code></pre></div>
</div>
<div id="a-large-volume-of-levels-in-a-categorical-variable" class="section level3">
<h3 class="hasAnchor">
<a href="#a-large-volume-of-levels-in-a-categorical-variable" class="anchor"></a>A Large Volume of Levels in a Categorical Variable</h3>
<p>As previously discussed, a statistical model that incorporates categorical variables with k &gt; 1 unique values will code k-1 separate columns of indicator variables. Variables displaying user-generated text or unique identifiers may have unique values in all or nearly all of the rows of the data set. Large values of k in a single variable can create computational burdens or lead to intractable structures. Models with such a large number of additional columns may run nearly interminably without any indication of the underlying issue or an estimate of the time to completion.</p>
<p>To avoid this issue, formulaic’s create.formula function allows the user to specify the <strong>max.input.categories</strong>. Each categorical variable’s number of levels k is computed at a global level. Any such variable with a value of k greater than max.input.categories is automatically excluded from consideration. This shows up in the calculation of the <strong>min.categories</strong> value and subsequently the <strong>exclude.numerous.categories</strong> of the <strong>inclusion.table</strong>.</p>
<p>As an example, the snack.dat’s <strong>User ID</strong> variable is a character vector that indicates which of the 1000 respondents supplied the answers for the given row. Including the User ID in a model would therefore generate 999 columns of indicator variables. When <strong>reduce = TRUE</strong>, a data set is supplied, and <strong>max.input.categories</strong> is set at a value below 1000, then the User ID would be automatically excluded from the formula:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/create.formula.html">create.formula</a></span><span class="op">(</span>
  outcome.name <span class="op">=</span> <span class="va">satisfaction.name</span>,
  input.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">age.name</span>, <span class="va">income.name</span>, <span class="va">region.name</span>, <span class="va">id.name</span><span class="op">)</span>,
  dat <span class="op">=</span> <span class="va">snack.dat</span>,
  reduce <span class="op">=</span> <span class="cn">TRUE</span>,
  max.input.categories <span class="op">=</span> <span class="fl">30</span>
<span class="op">)</span><span class="op">$</span><span class="va">formula</span>
<span class="co">#&gt; Satisfaction ~ Age + Income + Region</span>
<span class="co">#&gt; &lt;environment: 0x00000000216d6b38&gt;</span></code></pre></div>
</div>
<div id="inspection-of-all-variables" class="section level3">
<h3 class="hasAnchor">
<a href="#inspection-of-all-variables" class="anchor"></a>Inspection of All Variables</h3>
<p>When <strong>reduce = TRUE</strong> and a data set is supplied, the create.formula function provides a range of quality checks and information about the merits of including specific variables as possible inputs in a model. From the list of all of the variables, a user can quickly identify a reduced list for potential inclusion. As an example, we use the snack.dat to show that a model of awareness would need to be limited to a subset of the overall variables:</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/create.formula.html">create.formula</a></span><span class="op">(</span>
  outcome.name <span class="op">=</span> <span class="va">income.name</span>,
  input.names <span class="op">=</span> <span class="st">"."</span>,
  reduce <span class="op">=</span> <span class="cn">TRUE</span>,
  dat <span class="op">=</span> <span class="va">snack.dat</span>,
  max.input.categories <span class="op">=</span> <span class="fl">30</span>
<span class="op">)</span><span class="op">$</span><span class="va">formula</span>
<span class="co">#&gt; Warning in eval(jsub, SDenv, parent.frame()): NAs introduced by coercion</span>
<span class="co">#&gt; Income ~ Age + Gender + Region + Persona + Product + Awareness + </span>
<span class="co">#&gt;     BP_For_Me_0_10 + BP_Fits_Budget_0_10 + BP_Tastes_Great_0_10 + </span>
<span class="co">#&gt;     BP_Good_To_Share_0_10 + BP_Like_Logo_0_10 + BP_Special_Occasions_0_10 + </span>
<span class="co">#&gt;     BP_Everyday_Snack_0_10 + BP_Healthy_0_10 + BP_Delicious_0_10 + </span>
<span class="co">#&gt;     BP_Right_Amount_0_10 + BP_Relaxing_0_10 + Consideration + </span>
<span class="co">#&gt;     Consumption + Satisfaction + Advocacy + `Age Group` + `Income Group`</span>
<span class="co">#&gt; &lt;environment: 0x0000000022a46860&gt;</span></code></pre></div>
<p>All of the brand perceptions and other states of engagement were removed from the formula. This was due to a lack of contrast arising from the structurally missing values when the respondents were not aware of the product. Meanwhile, the User ID was removed due to its large number of categories. Only the names of the products and the respondent-specific variables remain. From this list, an investigator could then make selections of which variables to include (e.g. Age or Age Group). However, much of the preliminary investigation would be handled automatically. This is especially helpful in settings in which the full relationship of the variables – such as the sequence and dependencies of the marketing survey’s questions – is not yet fully understood.</p>
</div>
<div id="transformation" class="section level3">
<h3 class="hasAnchor">
<a href="#transformation" class="anchor"></a>Transformation</h3>
<p>Rather than looking for the names of existing variables, the updated create.formula evaluates the inputs and outcomes to see if real results are generated. With the changes, users can set any tranformed inputs such as sqrt(Age^2 * log(Income)) for inclusion. Likewise, the outcomes can also be transformations like log(Income).</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="fu"><a href="../reference/create.formula.html">create.formula</a></span><span class="op">(</span>
  outcome.name <span class="op">=</span> <span class="va">income.name</span>,
  input.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">region.name</span>, <span class="va">gender.name</span>, <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"sqrt(%s^2) * log(%s)"</span>, <span class="va">age.name</span>, <span class="va">income.name</span><span class="op">)</span>, <span class="va">income.group.name</span>, <span class="st">"ldkao"</span><span class="op">)</span>,
  reduce <span class="op">=</span> <span class="cn">TRUE</span>,
  interactions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">gender.name</span>, <span class="va">income.group.name</span><span class="op">)</span><span class="op">)</span>,
  input.patterns <span class="op">=</span> <span class="cn">NULL</span>,
  force.main.effects <span class="op">=</span> <span class="cn">TRUE</span>,
  max.input.categories <span class="op">=</span> <span class="fl">20</span>,
  max.outcome.categories.to.search <span class="op">=</span> <span class="fl">4</span>,
  order.as <span class="op">=</span> <span class="st">"as.specified"</span>,
  include.backtick <span class="op">=</span> <span class="st">"as.needed"</span>,
  format.as <span class="op">=</span> <span class="st">"formula"</span>,
  variables.to.exclude <span class="op">=</span> <span class="cn">NULL</span>,
  include.intercept <span class="op">=</span> <span class="cn">TRUE</span>,
  dat <span class="op">=</span> <span class="va">snack.dat</span>
<span class="op">)</span><span class="op">$</span><span class="va">formula</span>
<span class="co">#&gt; Income ~ Region + Gender + sqrt(Age^2) * log(Income) + `Income Group` + </span>
<span class="co">#&gt;     Gender * `Income Group`</span>
<span class="co">#&gt; &lt;environment: 0x00000000190b5d08&gt;</span></code></pre></div>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create.formula.html">create.formula</a></span><span class="op">(</span>outcome.name <span class="op">=</span> <span class="va">outcome.name</span>, input.names <span class="op">=</span> <span class="va">input.names</span>, interactions <span class="op">=</span> <span class="va">interactions</span>, dat <span class="op">=</span> <span class="va">snack.dat</span>, reduce <span class="op">=</span> <span class="va">reduce</span><span class="op">)</span>


<span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create.formula.html">create.formula</a></span><span class="op">(</span>outcome.name <span class="op">=</span> <span class="va">awareness.name</span>, input.names <span class="op">=</span> <span class="va">input.names</span>, interactions <span class="op">=</span> <span class="va">interactions</span>, dat <span class="op">=</span> <span class="va">snack.dat</span>, reduce <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>


<span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">res</span><span class="op">$</span><span class="va">formula</span>, data <span class="op">=</span> <span class="va">snack.dat</span>, family <span class="op">=</span> <span class="st">"binomial"</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:  glm(formula = res$formula, family = "binomial", data = snack.dat)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Coefficients:</span>
<span class="co">#&gt;           (Intercept)                    Age             GenderMale  </span>
<span class="co">#&gt;             2.166e-01             -1.879e-03             -1.786e-01  </span>
<span class="co">#&gt;                Income         Age:GenderMale             Age:Income  </span>
<span class="co">#&gt;            -4.874e-07              2.512e-03              1.633e-08  </span>
<span class="co">#&gt;     GenderMale:Income  Age:GenderMale:Income  </span>
<span class="co">#&gt;             9.725e-07             -2.824e-08  </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Degrees of Freedom: 22999 Total (i.e. Null);  22992 Residual</span>
<span class="co">#&gt; Null Deviance:       31820 </span>
<span class="co">#&gt; Residual Deviance: 31810     AIC: 31830</span>

<span class="va">res</span>
<span class="co">#&gt; $formula</span>
<span class="co">#&gt; Awareness ~ Age + Gender + Income + Age * Gender + Age * Income + </span>
<span class="co">#&gt;     Age * Gender * Income</span>
<span class="co">#&gt; &lt;environment: 0x000000002326e840&gt;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $inclusion.table</span>
<span class="co">#&gt;    variable exclude.null.quantity   class order specified.from</span>
<span class="co">#&gt; 1:      Age                 FALSE integer     1    input.names</span>
<span class="co">#&gt; 2:     Typo                  TRUE    &lt;NA&gt;     2    input.names</span>
<span class="co">#&gt; 3:   Gender                 FALSE  factor     3   interactions</span>
<span class="co">#&gt; 4:   Income                 FALSE numeric     4   interactions</span>
<span class="co">#&gt; 5:     Inco                  TRUE    &lt;NA&gt;     5   interactions</span>
<span class="co">#&gt; 6:  Reg ion                  TRUE    &lt;NA&gt;     6   interactions</span>
<span class="co">#&gt;    exclude.user.specified exclude.matches.outcome.name min.categories</span>
<span class="co">#&gt; 1:                  FALSE                        FALSE             75</span>
<span class="co">#&gt; 2:                     NA                        FALSE             NA</span>
<span class="co">#&gt; 3:                  FALSE                        FALSE              2</span>
<span class="co">#&gt; 4:                  FALSE                        FALSE            138</span>
<span class="co">#&gt; 5:                     NA                        FALSE             NA</span>
<span class="co">#&gt; 6:                     NA                        FALSE             NA</span>
<span class="co">#&gt;    exclude.lack.contrast exclude.numerous.categories include.variable</span>
<span class="co">#&gt; 1:                 FALSE                       FALSE             TRUE</span>
<span class="co">#&gt; 2:                    NA                          NA            FALSE</span>
<span class="co">#&gt; 3:                 FALSE                       FALSE             TRUE</span>
<span class="co">#&gt; 4:                 FALSE                       FALSE             TRUE</span>
<span class="co">#&gt; 5:                    NA                          NA            FALSE</span>
<span class="co">#&gt; 6:                    NA                          NA            FALSE</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $interactions.table</span>
<span class="co">#&gt;             interactions include.interaction</span>
<span class="co">#&gt; 1:          Age * Gender                TRUE</span>
<span class="co">#&gt; 2:          Age * Income                TRUE</span>
<span class="co">#&gt; 3: Age * Gender * Income                TRUE</span>
<span class="co">#&gt; 4:         Gender * Inco               FALSE</span>
<span class="co">#&gt; 5:         Age * Reg ion               FALSE</span></code></pre></div>
</div>
</div>
<div id="reducing-an-existing-formula-reduce-existing-formula" class="section level2">
<h2 class="hasAnchor">
<a href="#reducing-an-existing-formula-reduce-existing-formula" class="anchor"></a>Reducing an Existing Formula (reduce.existing.formula):</h2>
<p>The <strong>reduce.existing.formula</strong> function was designed to perform quality checks and automatic removal of impractical variables can also be accessed when an <strong>existing formula</strong> has been previously constructed. This method uses natural language processing techniques to deconstruct the components of a formula. Each variable and interaction is separately identified and aggregated. These variables are then supplied to create.formula as the input.names and interactions parameters. Otherwise, the parameters of reduce.existing.formula are designed to match those of create.formula. As a result, an initial formula can be evaluated in terms of the same set of quality checks, and the formula can be reduced based on the same set of exclusions.</p>
<div id="parameter-description-1" class="section level3">
<h3 class="hasAnchor">
<a href="#parameter-description-1" class="anchor"></a>Parameter description:</h3>
<ul>
<li>the.initial.formula object of class “lm” or for multiple responses of class c(“mlm”, “lm”).</li>
<li>dat Data frame, list or environment (or object coercible by as.data.frame to a data frame) containing the variables in the model.</li>
<li>max.input.categories This limits the maximum number of variables that will be employed in the formula. As default it is set at 20, but users can still change at his/her convenience.</li>
<li>max.outcome.categories.to.search This limits the maximum number of outcome categories will be investigated in the formula. As default it is set at 4, but users can still change at his/her convenience</li>
<li>order.as rearranges its first argument into ascending or descending order.</li>
<li>include.backtick Add backticks to make a appropriate variable</li>
<li>format.as The data type of the output. If not set as “formula”, then a character vector will be returned.</li>
</ul>
<p>As an example, we will demonstrate that a user-supplied formula will produce the same results as that created in the previous section:</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">the.initial.formula</span> <span class="op">&lt;-</span> <span class="st">'Income ~ .'</span>

<span class="fu"><a href="../reference/reduce.existing.formula.html">reduce.existing.formula</a></span><span class="op">(</span>
  the.initial.formula <span class="op">=</span> <span class="va">the.initial.formula</span>,
  dat <span class="op">=</span> <span class="va">snack.dat</span>,
  max.input.categories <span class="op">=</span> <span class="fl">30</span>
<span class="op">)</span><span class="op">$</span><span class="va">formula</span>
<span class="co">#&gt; Warning in eval(jsub, SDenv, parent.frame()): NAs introduced by coercion</span>
<span class="co">#&gt; Income ~ Age + Gender + Region + Persona + Product + Awareness + </span>
<span class="co">#&gt;     BP_For_Me_0_10 + BP_Fits_Budget_0_10 + BP_Tastes_Great_0_10 + </span>
<span class="co">#&gt;     BP_Good_To_Share_0_10 + BP_Like_Logo_0_10 + BP_Special_Occasions_0_10 + </span>
<span class="co">#&gt;     BP_Everyday_Snack_0_10 + BP_Healthy_0_10 + BP_Delicious_0_10 + </span>
<span class="co">#&gt;     BP_Right_Amount_0_10 + BP_Relaxing_0_10 + Consideration + </span>
<span class="co">#&gt;     Consumption + Satisfaction + Advocacy + `Age Group` + `Income Group`</span>
<span class="co">#&gt; &lt;environment: 0x0000000018c274c0&gt;</span></code></pre></div>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by David Shilane, Anderson Nelson, Caffrey Lee, Zichen Huang.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
