<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Dynamic Generation and Quality Checks of Formula Objects • formulaic</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Dynamic Generation and Quality Checks of Formula Objects">
<meta property="og:description" content="Many statistical models and analyses in R are implemented through formula objects. The formulaic package creates a unified approach for programmatically and dynamically generating formula objects. Users may specify the outcome and inputs of a model directly, search for variables to include based upon naming patterns, incorporate interactions, and identify variables to exclude. A wide range of quality checks are implemented to identify issues such as misspecified variables, duplication, a lack of contrast in the inputs, and a large number of levels in categorical data.  Variables that do not meet these quality checks can be automatically excluded from the model.  These issues are documented and reported in a manner that provides greater accountability and useful information to guide an investigation of the data.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">formulaic</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.8</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/Introduction-to-formulaic.html">Introduction to Formulaic</a>
    </li>
  </ul>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/dachosen1/formulaic/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div id="formulaic" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#formulaic" class="anchor"></a>formulaic</h1></div>

<div id="overview" class="section level2">
<h2 class="hasAnchor">
<a href="#overview" class="anchor"></a>Overview</h2>
<p><strong>Formulaic</strong> is useful in creating a dynamic formula with multiple features. It not only diminishes the time required for modeling and implementing, but also enriches the quality of the result. Many statistical models and analyses in R are implemented through formula objects. The formulaic package creates a unified approach for programmatically and dynamically generating formula objects in R. Users may specify the inputs and outcomes of a model directly, search for variables to include based upon naming patterns, and identify variables to exclude. A wide range of quality checks is implemented to identify issues such as misspecified variables, duplication, a lack of contrast in the inputs, and a large number of levels in categorical data. These issues are documented and reported in a manner that provides greater accountability and useful information to guide the investigator’s choices in selecting features. Dynamically generated formula objects can enable the development of applications that incorporate a user’s inputs for selecting the variables of a model and the subsets of data to include. The quality checks enable a programmatic reduction of the inputs to those that are appropriate for inclusion in the model. By automatically limiting these selections, many models that would lead to errors or intractable computations may be proactively avoided. By performing this process in the creation of the formula, all statistical models and analyses relying on formula objects can easily make use of these features. Furthermore, the list of quality checks can be easily expanded to incorporate additional concerns.</p>
</div>
<div id="install-the-current-release-from-cran" class="section level2">
<h2 class="hasAnchor">
<a href="#install-the-current-release-from-cran" class="anchor"></a>Install the current release from CRAN:</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">'formulaic'</span><span class="op">)</span></code></pre></div>
</div>
<div id="install-the-development-version-from-github" class="section level2">
<h2 class="hasAnchor">
<a href="#install-the-development-version-from-github" class="anchor"></a>Install the development version from GitHub:</h2>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://devtools.r-lib.org//reference/remote-reexports.html">install_github</a></span><span class="op">(</span><span class="st">'dachosen1/formulaic'</span><span class="op">)</span></code></pre></div>
</div>
<div id="usage" class="section level2">
<h2 class="hasAnchor">
<a href="#usage" class="anchor"></a>Usage</h2>
<p>Formulaic package has two main functions – <strong>create.formula</strong> and <strong>reduce.existing.formula</strong> – and one subsidiary function, <strong>add.backticks</strong>. The main purpose of developing the package is to help users to build a robust model faster and more convenient.</p>
<p><strong>create.formula</strong> automatically creates a formula from a provided list of input variables and the output variable. The variables will undergo a series of qualification tests such as automatic variable/categories reduction, typo, duplication, and lack of contrasted features elimination, etc. to make sure that a given feature is used for modeling. This will reduce the time to build a model and set the users free from the trivial maneuver: manually inputting variables for modeling. The outcome of this formula can be used in a wide range from simple linear regression to any machine learning techniques such as random forest, neural network, etc.</p>
<p>The principal advantages of using create.formula are as followed:</p>
<p>1) Being able to dynamically generate a formula from a vector of inputs, without necessarily having to spell them all out by name.</p>
<p>2) Adding variables by searching for patterns.</p>
<p>3) Simple integration of interactions.</p>
<p>4) Easy removal of specific variables.</p>
<p>5) Quality checks that resolve a variety of issues – typos, duplication, lack of contrast, etc. – while providing a transparent explanation.</p>
<p><strong>reduce.existing.formula</strong> Trims existing formula . Users plug an existing formula into the function; then, it will undergo the same test as create.formula.</p>
<p><strong>add.backticks</strong> applies backticks to the variables that require backticks to be employed in a formula as default. Users can also add backticks to all the variables; however, it is not necessary.</p>
<div id="example" class="section level3">
<h3 class="hasAnchor">
<a href="#example" class="anchor"></a>Example</h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">10</span>
<span class="va">dd</span> <span class="op">&lt;-</span> <span class="fu">data.table</span><span class="fu">::</span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/data.table.html">data.table</a></span><span class="op">(</span>w <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span>n<span class="op">=</span> <span class="va">n</span><span class="op">)</span>, x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">n</span><span class="op">)</span>, pixel_1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">n</span><span class="op">)</span><span class="op">)</span>
<span class="va">dd</span><span class="op">[</span>, <span class="st">'pixel 2'</span> <span class="op">:=</span> <span class="fl">0.3</span> <span class="op">*</span> <span class="va">pixel_1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">]</span>
<span class="va">dd</span><span class="op">[</span>, <span class="va">pixel_3</span> <span class="op">:=</span> <span class="fl">0.3</span> <span class="op">*</span> <span class="va">pixel_1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">]</span>
<span class="va">dd</span><span class="op">[</span>, <span class="va">item_1</span> <span class="op">:=</span> <span class="fl">0.3</span> <span class="op">*</span> <span class="va">pixel_3</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">]</span>
<span class="va">dd</span><span class="op">[</span>, <span class="va">item_2</span> <span class="op">:=</span> <span class="fl">0.3</span> <span class="op">*</span> <span class="va">pixel_3</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">]</span>
<span class="va">dd</span><span class="op">[</span>, <span class="va">y</span> <span class="op">:=</span> <span class="fl">5</span> <span class="op">*</span> <span class="va">x</span> <span class="op">+</span> <span class="fl">3</span> <span class="op">*</span> <span class="va">pixel_1</span> <span class="op">+</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">pixel_3</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">]</span></code></pre></div>
<p>The resulting script create a data.table with 8 unique features.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="kw">names</span>(dd)</span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="st">"w"</span>       <span class="st">"x"</span>       <span class="st">"pixel_1"</span> <span class="st">"pixel 2"</span> <span class="st">"pixel_3"</span> <span class="st">"item_1"</span>  <span class="st">"item_2"</span>  <span class="st">"y"</span>  </span></code></pre></div>
<p>Traditionally, creating a formula in R required the user to select the desired variables or use the y~ . notation to select all the features. <strong><code>formulaic</code></strong> is useful to choose variables programmatically to include and perform a quality check against the input.</p>
<p><strong>use case:</strong> Creating a model with all pixel patterns</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># create formula object </span>
<span class="va">formula1</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/create.formula.html">create.formula</a></span><span class="op">(</span>outcome.name <span class="op">=</span> <span class="st">"y"</span>, input.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"x"</span>,<span class="st">"Random error"</span>, <span class="st">"y"</span><span class="op">)</span>, input.patterns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"pix"</span><span class="op">)</span>, dat <span class="op">=</span> <span class="va">dd</span><span class="op">)</span>

<span class="va">formula1</span><span class="op">$</span><span class="va">formula</span>
<span class="va">y</span> <span class="op">~</span> <span class="va">x</span> <span class="op">+</span> <span class="va">pixel_1</span> <span class="op">+</span> <span class="va">`pixel 2`</span> <span class="op">+</span> <span class="va">pixel_3</span></code></pre></div>
<p>The result is a formula object of all the pixel variables and the input x. Notice that the ‘Random error’ variable was automatically excluded from the output, and a backtick was automatically added to the variable pixel 2. Since the independent variable y was included as a feature, it was excluded from the output formula.</p>
<p>Details of the variables included are provided in the inclusion table</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="co"># inclustion table</span></span>
<span id="cb6-2"><a href="#cb6-2"></a><span class="op">&gt;</span><span class="st"> </span>formula1<span class="op">$</span>inclusion.table</span>
<span id="cb6-3"><a href="#cb6-3"></a>       variable   class order specified.from exclude.user.specified exclude.not.in.names.dat exclude.matches.outcome.name include.variable</span>
<span id="cb6-4"><a href="#cb6-4"></a><span class="dv">1</span><span class="op">:</span><span class="st">            </span>x numeric     <span class="dv">1</span>    input.names                  <span class="ot">FALSE</span>                    <span class="ot">FALSE</span>                        <span class="ot">FALSE</span>             <span class="ot">TRUE</span></span>
<span id="cb6-5"><a href="#cb6-5"></a><span class="dv">2</span><span class="op">:</span><span class="st"> </span>Random error    <span class="op">&lt;</span><span class="ot">NA</span><span class="op">&gt;</span><span class="st">     </span><span class="dv">2</span>    input.names                  <span class="ot">FALSE</span>                     <span class="ot">TRUE</span>                        <span class="ot">FALSE</span>            <span class="ot">FALSE</span></span>
<span id="cb6-6"><a href="#cb6-6"></a><span class="dv">3</span><span class="op">:</span><span class="st">            </span>y numeric     <span class="dv">3</span>    input.names                  <span class="ot">FALSE</span>                    <span class="ot">FALSE</span>                         <span class="ot">TRUE</span>            <span class="ot">FALSE</span></span>
<span id="cb6-7"><a href="#cb6-7"></a><span class="dv">4</span><span class="op">:</span><span class="st">      </span>pixel_<span class="dv">1</span> numeric     <span class="dv">4</span> input.patterns                  <span class="ot">FALSE</span>                    <span class="ot">FALSE</span>                        <span class="ot">FALSE</span>             <span class="ot">TRUE</span></span>
<span id="cb6-8"><a href="#cb6-8"></a><span class="dv">5</span><span class="op">:</span><span class="st">      </span>pixel <span class="dv">2</span> numeric     <span class="dv">5</span> input.patterns                  <span class="ot">FALSE</span>                    <span class="ot">FALSE</span>                        <span class="ot">FALSE</span>             <span class="ot">TRUE</span></span>
<span id="cb6-9"><a href="#cb6-9"></a><span class="dv">6</span><span class="op">:</span><span class="st">      </span>pixel_<span class="dv">3</span> numeric     <span class="dv">6</span> input.patterns                  <span class="ot">FALSE</span>                    <span class="ot">FALSE</span>                        <span class="ot">FALSE</span>             <span class="ot">TRUE</span></span>
<span id="cb6-10"><a href="#cb6-10"></a></span>
<span id="cb6-11"><a href="#cb6-11"></a><span class="co"># implement formula object</span></span>
<span id="cb6-12"><a href="#cb6-12"></a>model &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="dt">formula =</span> formula1, <span class="dt">data =</span> dd)</span></code></pre></div>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Download from CRAN at <br><a href="https://cloud.r-project.org/package=formulaic">https://​cloud.r-project.org/​package=formulaic</a>
</li>
<li>Browse source code at <br><a href="https://github.com/dachosen1/formulaic/">https://​github.com/​dachosen1/​formulaic/​</a>
</li>
<li>Report a bug at <br><a href="https://github.com/dachosen1/formulaic/issues">https://​github.com/​dachosen1/​formulaic/​issues</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li>
<a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> </li>
</ul>
</div>
<div class="community">
<h2>Community</h2>
<ul class="list-unstyled">
<li><a href="CODE_OF_CONDUCT.html">Code of conduct</a></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>David Shilane <br><small class="roles"> Author </small>  </li>
<li>Anderson Nelson <br><small class="roles"> Author, contributor, maintainer </small>  </li>
<li>Caffrey Lee <br><small class="roles"> Author, contributor </small>  </li>
<li>Zichen Huang <br><small class="roles"> Author, contributor </small>  </li>
</ul>
</div>

  <div class="dev-status">
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://www.codefactor.io/repository/github/dachosen1/formulaic/overview/master"><img src="https://www.codefactor.io/repository/github/dachosen1/formulaic/badge/master" alt="CodeFactor"></a></li>
<li><a href="https://codecov.io/gh/dachosen1/formulaic"><img src="https://codecov.io/gh/dachosen1/formulaic/branch/master/graph/badge.svg" alt="codecov"></a></li>
<li><a href="https://www.gnu.org/licenses/gpl-3.0.en.html"><img src="https://img.shields.io/badge/license-GPL--3-blue.svg" alt="license"></a></li>
<li><a href="https://CRAN.R-project.org/package=formulaic"><img src="https://www.r-pkg.org/badges/version/formulaic" alt="CRAN status"></a></li>
<li><a href="https://cran.r-project.org/package=formulaic"><img src="http://cranlogs.r-pkg.org/badges/grand-total/formulaic?color=blue"></a></li>
<li><a href="https://cran.r-project.org/package=formulaic"><img src="https://cranlogs.r-pkg.org/badges/formulaic"></a></li>
</ul>
</div>
</div>
</div>


      <footer><div class="copyright">
  <p>Developed by David Shilane, Anderson Nelson, Caffrey Lee, Zichen Huang.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
